<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãã ã¡AI (SODACHI AI) â€” AIãƒã‚¤ãƒ†ã‚£ãƒ–ä¿è‚²ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI','Hiragino Sans','Yu Gothic',system-ui,sans-serif;background:#F9FAFB}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-8px)}75%{transform:translateX(8px)}}
@keyframes spin{to{transform:rotate(360deg)}}
.shake{animation:shake .4s ease}
input:focus{outline:none;border-color:#10B981!important;box-shadow:0 0 0 3px rgba(16,185,129,.15)}
button{font-family:inherit}
::-webkit-scrollbar{width:6px}
::-webkit-scrollbar-thumb{background:#D1D5DB;border-radius:3px}
#lf{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#064E3B,#047857);color:#fff;font-size:18px;z-index:9999;flex-direction:column;gap:16px}
#lf .sp{width:40px;height:40px;border:3px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .8s linear infinite}
.toast{position:fixed;top:24px;right:24px;padding:14px 24px;border-radius:12px;color:#fff;font-weight:600;font-size:14px;z-index:10000;animation:fadeIn .3s ease;box-shadow:0 4px 20px rgba(0,0,0,.2)}
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;z-index:9000;animation:fadeIn .2s ease}
.modal-box{background:#fff;border-radius:20px;padding:32px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.2)}
.tab-active{background:#10B981!important;color:#fff!important;border-color:#10B981!important}
</style>
</head>
<body>
<div id="lf"><div class="sp"></div><div>ãã ã¡AI ã‚’èª­ã¿è¾¼ã¿ä¸­...</div></div>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useCallback,useMemo}=React;
document.getElementById('lf').style.display='none';

// ============================================================
// ãã ã¡AI v2.0 â€” Full Interactive Prototype
// ============================================================

const USERS=[
  {email:"s_tahara@skillupai.com",name:"ç”°åŸ çœä¸€",org:"ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—NeXt"},
  {email:"katokato666@yahoo.co.jp",name:"åŠ è—¤",org:""},
  {email:"wataru.yamaguchi.dp@fujifilm.com",name:"å±±å£ æ¸‰",org:"FBIJ"},
  {email:"tetsuya.kanome.wz@fujifilm.com",name:"é¹¿ç›® å“²ä¹Ÿ",org:"FBIJ"},
  {email:"takashi.ishii.ek@fujifilm.com",name:"çŸ³äº• éš†",org:"FBIJ"},
];
const PW="12345678";

const C={
  primary:"#10B981",primaryDark:"#059669",primaryLight:"#D1FAE5",
  accent:"#F59E0B",accentLight:"#FEF3C7",
  danger:"#EF4444",dangerLight:"#FEE2E2",
  info:"#3B82F6",infoLight:"#DBEAFE",
  purple:"#8B5CF6",purpleLight:"#EDE9FE",
  g50:"#F9FAFB",g100:"#F3F4F6",g200:"#E5E7EB",g300:"#D1D5DB",
  g500:"#6B7280",g700:"#374151",g900:"#111827",
};

// â”€â”€ Child Data â”€â”€
const CHILDREN=[
  {id:1,name:"ç”°ä¸­ ã‚†ã†ã¨",age:4,cls:"ã²ã¾ã‚ã‚Šçµ„",photo:"ğŸ§’",arrived:true,time:"8:12",parent:"æ¯",hr:92,spo2:98,temp:36.4},
  {id:2,name:"ä½è—¤ ã‚ãŠã„",age:3,cls:"ã²ã¾ã‚ã‚Šçµ„",photo:"ğŸ‘§",arrived:true,time:"8:25",parent:"çˆ¶",hr:88,spo2:99,temp:36.6},
  {id:3,name:"éˆ´æœ¨ ã¯ã‚‹ã¨",age:4,cls:"ã²ã¾ã‚ã‚Šçµ„",photo:"ğŸ§’",arrived:true,time:"8:31",parent:"ç¥–æ¯",hr:95,spo2:97,temp:36.3},
  {id:4,name:"é«˜æ©‹ ã²ãªãŸ",age:3,cls:"ã²ã¾ã‚ã‚Šçµ„",photo:"ğŸ‘§",arrived:true,time:"8:45",parent:"æ¯",hr:90,spo2:98,temp:36.5},
  {id:5,name:"ä¼Šè—¤ ãã†ãŸ",age:4,cls:"ã²ã¾ã‚ã‚Šçµ„",photo:"ğŸ§’",arrived:false,time:null,parent:null,hr:null,spo2:null,temp:null},
  {id:6,name:"æ¸¡è¾º ã‚ã„",age:3,cls:"ã²ã¾ã‚ã‚Šçµ„",photo:"ğŸ‘§",arrived:true,time:"9:02",parent:"çˆ¶",hr:87,spo2:99,temp:36.7},
  {id:7,name:"å±±æœ¬ ã‚Šã",age:5,cls:"ã•ãã‚‰çµ„",photo:"ğŸ§’",arrived:true,time:"8:08",parent:"æ¯",hr:91,spo2:98,temp:36.2},
  {id:8,name:"ä¸­æ‘ ã•ãã‚‰",age:5,cls:"ã•ãã‚‰çµ„",photo:"ğŸ‘§",arrived:true,time:"8:20",parent:"æ¯",hr:89,spo2:99,temp:36.5},
];

// Per-child journal data
const JOURNALS={
  1:{
    diary:"ä»Šæ—¥ã®ã‚†ã†ã¨ãã‚“ã¯ã€æœã®è‡ªç”±éŠã³ã®æ™‚é–“ã«ãƒ–ãƒ­ãƒƒã‚¯ã§å¤§ããªãŠåŸã‚’ä½œã£ã¦ã„ã¾ã—ãŸã€‚ã€Œå…ˆç”Ÿã€è¦‹ã¦ï¼ãŠåŸã§ããŸã‚ˆï¼ã€ã¨å¬‰ã—ãã†ã«æ•™ãˆã¦ãã‚Œã¾ã—ãŸã€‚\n\nãŠçµµæãã®æ™‚é–“ã«ã¯ã€ã‚¯ãƒ¬ãƒ¨ãƒ³ã‚’ä½¿ã£ã¦å®¶æ—ã®çµµã‚’æãã¾ã—ãŸã€‚ã€Œã“ã‚Œã¯ãƒ‘ãƒ‘ã€ã“ã‚Œã¯ãƒãƒã€ã“ã‚Œã¯ã¼ãï¼ã€ã¨ä¸€ã¤ã²ã¨ã¤èª¬æ˜ã—ã¦ãã‚Œã¾ã—ãŸã€‚\n\nå¤–éŠã³ã§ã¯ã€ä½è—¤ã‚ãŠã„ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«ç ‚å ´ã§éŠã³ã€å±±ã‚’ä½œã£ã¦æ¥½ã—ã‚“ã§ã„ã¾ã—ãŸã€‚\n\nçµ¦é£Ÿã¯ã»ã¼å®Œé£Ÿï¼ˆã”ã¯ã‚“90%ã€ä¸»èœ80%ï¼‰ã€‚ãŠã‹ã‚ã‚Šã‚‚1å›ã—ã¾ã—ãŸã€‚",
    parent:"ä»Šæ—¥ã®ã‚†ã†ã¨ãã‚“ã¯å…ƒæ°—ã„ã£ã±ã„ã«éã”ã—ã¾ã—ãŸğŸŒŸ\n\næœã¯ãƒ–ãƒ­ãƒƒã‚¯ã§å¤§ããªãŠåŸã‚’ä½œã‚Šã€ã¨ã¦ã‚‚æº€è¶³ãã†ã§ã—ãŸã€‚ãŠçµµæãã§ã¯ã”å®¶æ—ã®çµµã‚’æã„ã¦ã€ä¸€äººã²ã¨ã‚Šä¸å¯§ã«èª¬æ˜ã—ã¦ãã‚Œã¾ã—ãŸã‚ˆã€‚\n\nãŠå¤–ã§ã¯ä½è—¤ã‚ãŠã„ã¡ã‚ƒã‚“ã¨ç ‚å ´ã§ä»²è‰¯ãéŠã‚“ã§ã„ã¾ã—ãŸğŸ˜Š",
    photos:["ğŸ¨ ãŠçµµæã","ğŸ— ãƒ–ãƒ­ãƒƒã‚¯","â›± ç ‚å ´"],
    photoBg:["#FFE4C4","#B0E0E6","#F0E68C"],
    meal:{r:90,m:80,s:70,sp:100}
  },
  2:{
    diary:"ã‚ãŠã„ã¡ã‚ƒã‚“ã¯æœã‹ã‚‰ç¬‘é¡”ã§ç™»åœ’ã—ã¾ã—ãŸã€‚æœã®ä¼šã§ã¯å…ƒæ°—ã«ã€ŒãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ï¼ã€ã¨ã”æŒ¨æ‹¶ã€‚\n\nãŠçµµæãã®æ™‚é–“ã«ã¯ãƒ”ãƒ³ã‚¯ã®ã‚¯ãƒ¬ãƒ¨ãƒ³ã§ãŠèŠ±ã‚’ãŸãã•ã‚“æã„ã¦ã„ã¾ã—ãŸã€‚ã€ŒãŠèŠ±ç•‘ã ã‚ˆï¼ã€ã¨å¬‰ã—ãã†ã€‚\n\nãŠå¤–éŠã³ã§ã¯ã€ãƒ–ãƒ©ãƒ³ã‚³ãŒãŠæ°—ã«å…¥ã‚Šã§ã€Œã‚‚ã£ã¨é«˜ãã€œï¼ã€ã¨æ¥½ã—ã‚“ã§ã„ã¾ã—ãŸã€‚\n\nçµ¦é£Ÿã¯ãŠé­šãŒå°‘ã—è‹¦æ‰‹ãªæ§˜å­ã§ã—ãŸãŒã€ãŠå‘³å™Œæ±ã¯å®Œé£Ÿã—ã¾ã—ãŸã€‚",
    parent:"ã‚ãŠã„ã¡ã‚ƒã‚“ã€ä»Šæ—¥ã‚‚å…ƒæ°—ã«éã”ã—ã¾ã—ãŸã‚ˆğŸŒ¸\n\nãŠçµµæãã§ã¯ãã‚Œã„ãªãŠèŠ±ç•‘ã‚’æã„ã¦ãã‚Œã¾ã—ãŸã€‚ãƒ–ãƒ©ãƒ³ã‚³ã‚‚å¤§å¥½ãã§ã€ç¬‘é¡”ã„ã£ã±ã„ã®1æ—¥ã§ã—ãŸï¼\n\nãŠé­šã¯å°‘ã—æ®‹ã—ã¾ã—ãŸãŒã€ä»–ã¯ã‚ˆãé£Ÿã¹ã¦ã„ã¾ã™ğŸ˜Š",
    photos:["ğŸŒ¸ ãŠèŠ±çµµ","ğŸ  ãƒ–ãƒ©ãƒ³ã‚³","ğŸ± çµ¦é£Ÿ"],
    photoBg:["#FFB6C1","#E6E6FA","#98FB98"],
    meal:{r:85,m:60,s:75,sp:95}
  },
  3:{
    diary:"ã¯ã‚‹ã¨ãã‚“ã¯ä»Šæ—¥ã€ç©ã¿æœ¨ã§é«˜ã„ã‚¿ãƒ¯ãƒ¼ã‚’ä½œã‚‹ã“ã¨ã«æŒ‘æˆ¦ã—ã¦ã„ã¾ã—ãŸã€‚ä½•åº¦ã‚‚å´©ã‚Œã¾ã—ãŸãŒã€è«¦ã‚ãšã«æœ€å¾Œã«ã¯è‡ªåˆ†ã®èƒŒã®é«˜ã•ã¾ã§ç©ã¿ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼\n\nãŠå¤–ã§ã¯é¬¼ã”ã£ã“ã®ãƒªãƒ¼ãƒ€ãƒ¼ã‚’å‹™ã‚ã€ã€Œã“ã£ã¡ã ã‚ˆï¼ã€ã¨ã¿ã‚“ãªã‚’ã¾ã¨ã‚ã¦ã„ã¾ã—ãŸã€‚\n\nãŠæ˜¼å¯ã®æ™‚é–“ã«ã¯ãªã‹ãªã‹å¯ä»˜ã‘ãšã€å…ˆç”Ÿã®ãã°ã§çµµæœ¬ã‚’é™ã‹ã«è¦‹ã¦ã„ã¾ã—ãŸã€‚\n\nçµ¦é£Ÿã¯å®Œé£Ÿã€‚ãŠã‹ã‚ã‚Šã‚‚2å›ã—ã¾ã—ãŸã€‚",
    parent:"ã¯ã‚‹ã¨ãã‚“ã€ä»Šæ—¥ã¯ç©ã¿æœ¨ã§å¤§ããªã‚¿ãƒ¯ãƒ¼ã«æŒ‘æˆ¦ã—ã¾ã—ãŸğŸ—\n\nä½•åº¦å´©ã‚Œã¦ã‚‚ã‚ã’ãšã«é ‘å¼µã‚Šã€æœ€å¾Œã¯è‡ªåˆ†ã®èƒŒã®é«˜ã•ã¾ã§å®Œæˆï¼ãŠå¤–ã§ã¯é¬¼ã”ã£ã“ã§ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã¦ã„ã¾ã—ãŸã‚ˆğŸ’ª\n\nãŸãã•ã‚“é£Ÿã¹ã¦å…ƒæ°—ã„ã£ã±ã„ã§ã™",
    photos:["ğŸ— ç©ã¿æœ¨","ğŸƒ é¬¼ã”ã£ã“","ğŸ“– çµµæœ¬"],
    photoBg:["#DEB887","#87CEEB","#FFDAB9"],
    meal:{r:100,m:95,s:80,sp:100}
  },
  4:{
    diary:"ã²ãªãŸã¡ã‚ƒã‚“ã¯ä»Šæ—¥ã€ãŠã¾ã¾ã”ã¨ã‚³ãƒ¼ãƒŠãƒ¼ã§ãŠæ–™ç†ã”ã£ã“ã‚’æ¥½ã—ã‚“ã§ã„ã¾ã—ãŸã€‚ã€Œã¯ã„ã€ã©ã†ãï¼ã€ã¨ãŠå‹é”ã«ãŠæ–™ç†ã‚’é…ã£ã¦å›ã‚‹å§¿ãŒã¨ã¦ã‚‚å¾®ç¬‘ã¾ã—ã‹ã£ãŸã§ã™ã€‚\n\nåˆ¶ä½œã®æ™‚é–“ã«ã¯æŠ˜ã‚Šç´™ã§çŠ¬ã‚’ä¸Šæ‰‹ã«æŠ˜ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚\n\nåˆå¾Œã¯ãŠæ˜¼å¯ã®ã‚ã¨ã«ãŠã‚„ã¤ã‚’é£Ÿã¹ã¦ã€ç²˜åœŸéŠã³ã«é›†ä¸­ã—ã¦ã„ã¾ã—ãŸã€‚\n\nçµ¦é£Ÿã§ã¯ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œé£Ÿï¼ˆåµä¸ä½¿ç”¨ï¼‰ã‚’æä¾›ã€‚ã‚ˆãé£Ÿã¹ã¦ã„ã¾ã—ãŸã€‚",
    parent:"ã²ãªãŸã¡ã‚ƒã‚“ã€ä»Šæ—¥ã¯ãŠã¾ã¾ã”ã¨ã§ãŸãã•ã‚“ãŠæ–™ç†ã‚’ä½œã£ã¦ãŠå‹é”ã«é…ã£ã¦ãã‚Œã¾ã—ãŸğŸ³\n\næŠ˜ã‚Šç´™ã§ã¯çŠ¬ã‚’ä¸Šæ‰‹ã«æŠ˜ã‚Œã¾ã—ãŸã‚ˆï¼åˆå¾Œã¯ç²˜åœŸã§ã„ã‚ã‚“ãªå½¢ã‚’ä½œã£ã¦æ¥½ã—ã‚“ã§ã„ã¾ã—ãŸâœ¨\n\nã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œé£Ÿã€ã—ã£ã‹ã‚Šé£Ÿã¹ã¦ã„ã¾ã™",
    photos:["ğŸ³ ãŠã¾ã¾ã”ã¨","ğŸ• æŠ˜ã‚Šç´™","ğŸ¨ ç²˜åœŸ"],
    photoBg:["#FAFAD2","#E0FFFF","#FFF0F5"],
    meal:{r:88,m:85,s:65,sp:90}
  },
  6:{
    diary:"ã‚ã„ã¡ã‚ƒã‚“ã¯å°‘ã—é…ã‚Œã¦ã®ç™»åœ’ã§ã—ãŸãŒã€ã™ãã«ãŠå‹é”ã®è¼ªã«å…¥ã£ã¦å…ƒæ°—ã«éŠã³å§‹ã‚ã¾ã—ãŸã€‚\n\nãƒªã‚ºãƒ éŠã³ã®æ™‚é–“ã«ã¯ã‚¿ãƒ³ãƒãƒªãƒ³ã‚’ä¸Šæ‰‹ã«ãŸãŸã„ã¦ã€ã¿ã‚“ãªã®å‰ã§æ¼”å¥ã‚’æŠ«éœ²ã—ã¦ãã‚Œã¾ã—ãŸã€‚\n\nå¤–éŠã³ã§ã¯æ°´ãŸã¾ã‚Šã«èˆˆå‘³æ´¥ã€…ã§ã€é•·é´ã§ãƒã‚·ãƒ£ãƒã‚·ãƒ£ã¨æ¥½ã—ã‚“ã§ã„ã¾ã—ãŸã€‚\n\nçµ¦é£Ÿã¯ã‚ˆãé£Ÿã¹ã¾ã—ãŸãŒã€ã»ã†ã‚Œã‚“è‰ã®ãŠã²ãŸã—ã¯å°‘ã—æ®‹ã—ã¾ã—ãŸã€‚",
    parent:"ã‚ã„ã¡ã‚ƒã‚“ã€å°‘ã—é…ã‚ã®ç™»åœ’ã§ã—ãŸãŒå…ƒæ°—ã«éã”ã—ã¾ã—ãŸã‚ˆğŸµ\n\nãƒªã‚ºãƒ éŠã³ã§ã‚¿ãƒ³ãƒãƒªãƒ³ã®æ¼”å¥ã‚’æŠ«éœ²ã—ã¦ãã‚Œã¾ã—ãŸï¼ãŠå¤–ã§ã¯æ°´ãŸã¾ã‚Šã§å¤§ã¯ã—ã‚ƒãğŸ˜„\n\nãŠé‡èœãŒã¡ã‚‡ã£ã¨è‹¦æ‰‹ã¿ãŸã„ã§ã™ãŒã€ä»–ã¯ã‚‚ã‚Šã‚‚ã‚Šé£Ÿã¹ã¦ã„ã¾ã™",
    photos:["ğŸµ ã‚¿ãƒ³ãƒãƒªãƒ³","ğŸ’§ æ°´ãŸã¾ã‚Š","ğŸ¥— çµ¦é£Ÿ"],
    photoBg:["#FFE4E1","#B0C4DE","#F5F5DC"],
    meal:{r:92,m:78,s:55,sp:88}
  },
  7:{
    diary:"ã‚Šããã‚“ã¯ã•ãã‚‰çµ„ã®å¹´é•·ã•ã‚“ã¨ã—ã¦ã€ä»Šæ—¥ã¯å°ã•ã„ãŠå‹é”ã®ãŠä¸–è©±ã‚’ç©æ¥µçš„ã«è¡Œã£ã¦ã„ã¾ã—ãŸã€‚\n\nã²ã‚‰ãŒãªã®ç·´ç¿’ã§ã¯ã€Œã‚Šã€ã€Œãã€ã¨è‡ªåˆ†ã®åå‰ã‚’ä¸å¯§ã«æ›¸ãã“ã¨ãŒã§ãã¾ã—ãŸã€‚\n\nä½“æ“ã®æ™‚é–“ã«ã¯å‰è»¢ãŒä¸Šæ‰‹ã«ã§ãã€å…ˆç”Ÿã«è¤’ã‚ã‚‰ã‚Œã¦ã¨ã¦ã‚‚å¬‰ã—ãã†ã§ã—ãŸã€‚\n\nçµ¦é£Ÿã¯å¥½ãå«Œã„ãªãå…¨éƒ¨é£Ÿã¹ã¾ã—ãŸã€‚",
    parent:"ã‚Šããã‚“ã€ä»Šæ—¥ã¯å¹´é•·ã•ã‚“ã‚‰ã—ãå°ã•ã„ãŠå‹é”ã®ãŠä¸–è©±ã‚’é ‘å¼µã£ã¦ã„ã¾ã—ãŸğŸ‘\n\nã²ã‚‰ãŒãªã§è‡ªåˆ†ã®ãŠåå‰ã‚’æ›¸ãç·´ç¿’ã‚‚é †èª¿ã§ã™ã€‚ä½“æ“ã§ã¯å‰è»¢ãŒãã‚Œã„ã«ã§ãã¾ã—ãŸã‚ˆï¼\n\nçµ¦é£Ÿã¯å®Œé£Ÿã§ã—ãŸğŸš",
    photos:["âœï¸ ã²ã‚‰ãŒãª","ğŸ¤¸ å‰è»¢","ğŸ¤ ãŠä¸–è©±"],
    photoBg:["#FFFACD","#E0FFE0","#FFE4B5"],
    meal:{r:95,m:90,s:88,sp:100}
  },
  8:{
    diary:"ã•ãã‚‰ã¡ã‚ƒã‚“ã¯ä»Šæ—¥ã€ãŠå‹é”ã¨ä¸€ç·’ã«å¤§ããªãƒ‘ã‚ºãƒ«ã‚’å®Œæˆã•ã›ã¾ã—ãŸã€‚ã€Œã§ããŸï¼ã€ã¨ã¿ã‚“ãªã§ãƒã‚¤ã‚¿ãƒƒãƒã€‚\n\néŸ³æ¥½ã®æ™‚é–“ã«ã¯ãƒ”ã‚¢ãƒ‹ã‚«ã®ç·´ç¿’ã§ã€Œãã‚‰ãã‚‰æ˜Ÿã€ã‚’æœ€å¾Œã¾ã§å¼¾ãã“ã¨ãŒã§ãã¾ã—ãŸã€‚\n\næ˜¼é£Ÿå¾Œã¯çµµæœ¬ã‚³ãƒ¼ãƒŠãƒ¼ã§ãŠå‹é”ã«èª­ã¿èã‹ã›ã‚’ã—ã¦ã‚ã’ã¦ã„ã¾ã—ãŸã€‚\n\nçµ¦é£Ÿã¯ãŠã‹ã‚ã‚Šã‚’1å›ã—ã¾ã—ãŸã€‚",
    parent:"ã•ãã‚‰ã¡ã‚ƒã‚“ã€ä»Šæ—¥ã¯ãŠå‹é”ã¨ãƒ‘ã‚ºãƒ«ã‚’å”åŠ›ã—ã¦å®Œæˆã•ã›ã¾ã—ãŸğŸ§©\n\nãƒ”ã‚¢ãƒ‹ã‚«ã§ã€Œãã‚‰ãã‚‰æ˜Ÿã€ã‚’å¼¾ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã‚ˆğŸ¹ ãŠå‹é”ã«çµµæœ¬ã‚’èª­ã‚“ã§ã‚ã’ã‚‹å„ªã—ã„å§¿ã‚‚è¦‹ã‚‰ã‚Œã¾ã—ãŸã€‚\n\nã‚ˆãé£Ÿã¹ã¦ã„ã¾ã™ğŸ˜Š",
    photos:["ğŸ§© ãƒ‘ã‚ºãƒ«","ğŸ¹ ãƒ”ã‚¢ãƒ‹ã‚«","ğŸ“š èª­ã¿èã‹ã›"],
    photoBg:["#D8BFD8","#AFEEEE","#FFEFD5"],
    meal:{r:88,m:82,s:78,sp:95}
  }
};

// â”€â”€ Vital Data Generation â”€â”€
const seed=(s)=>{let x=Math.sin(s)*10000;return x-Math.floor(x)};

const genVitalToday=(childId)=>Array.from({length:20},(_,i)=>{
  const s=seed(childId*1000+i);
  return{time:`${Math.floor(8+i*0.5)}:${i%2===0?"00":"30"}`,hr:Math.floor(72+s*28),spo2:Math.floor(96+seed(childId*2000+i)*4),temp:+(36+seed(childId*3000+i)*0.8).toFixed(1)};
});

const genVitalWeek=(childId)=>Array.from({length:7},(_,i)=>{
  const d=new Date();d.setDate(d.getDate()-6+i);
  const s=seed(childId*100+i);
  return{date:`${d.getMonth()+1}/${d.getDate()}`,day:["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][d.getDay()],
    hrAvg:Math.floor(78+s*18),hrMin:Math.floor(65+s*10),hrMax:Math.floor(90+s*20),
    spo2Avg:Math.floor(96.5+seed(childId*200+i)*2.5),tempAvg:+(36.2+seed(childId*300+i)*0.5).toFixed(1),
    sleepScore:Math.floor(70+seed(childId*400+i)*25)};
});

const genVitalMonth=(childId)=>Array.from({length:28},(_,i)=>{
  const d=new Date();d.setDate(d.getDate()-27+i);
  const s=seed(childId*50+i);
  return{date:`${d.getMonth()+1}/${d.getDate()}`,hrAvg:Math.floor(76+s*20),spo2Avg:Math.floor(96+seed(childId*60+i)*3),
    tempAvg:+(36.1+seed(childId*70+i)*0.6).toFixed(1),sleepScore:Math.floor(65+seed(childId*80+i)*30)};
});

const genVitalYear=(childId)=>Array.from({length:12},(_,i)=>{
  const m=((new Date().getMonth()-11+i+12)%12)+1;
  const s=seed(childId*10+i);
  return{month:`${m}æœˆ`,hrAvg:Math.floor(75+s*20),spo2Avg:Math.floor(96.5+seed(childId*20+i)*2.5),
    tempAvg:+(36.2+seed(childId*30+i)*0.5).toFixed(1),sleepScore:Math.floor(68+seed(childId*40+i)*28)};
});

const ACTIVITIES=[
  {time:"8:00",act:"ç™»åœ’ãƒ»è‡ªç”±éŠã³",icon:"ğŸ "},{time:"9:30",act:"æœã®ä¼š",icon:"ğŸµ"},
  {time:"10:00",act:"ãŠçµµæãæ´»å‹•",icon:"ğŸ¨"},{time:"11:00",act:"å¤–éŠã³ï¼ˆåœ’åº­ï¼‰",icon:"ğŸŒ³"},
  {time:"11:45",act:"æ‰‹æ´—ã„ãƒ»çµ¦é£Ÿæº–å‚™",icon:"ğŸ§¼"},{time:"12:00",act:"çµ¦é£Ÿ",icon:"ğŸ±"},
  {time:"13:00",act:"ãŠæ˜¼å¯",icon:"ğŸ˜´"},{time:"15:00",act:"ãŠã‚„ã¤",icon:"ğŸª"},
  {time:"15:30",act:"è‡ªç”±éŠã³ãƒ»é™åœ’",icon:"ğŸ‘‹"},
];
const GROWTH=[{m:"4æœˆ",h:98.2,w:15.1},{m:"5æœˆ",h:98.8,w:15.3},{m:"6æœˆ",h:99.5,w:15.4},{m:"7æœˆ",h:100.1,w:15.6},{m:"8æœˆ",h:100.5,w:15.8},{m:"9æœˆ",h:101.2,w:16.0},{m:"10æœˆ",h:101.8,w:16.1},{m:"11æœˆ",h:102.3,w:16.3},{m:"12æœˆ",h:102.9,w:16.5},{m:"1æœˆ",h:103.4,w:16.6},{m:"2æœˆ",h:103.9,w:16.8}];
const PLAN=[
  {m:"4æœˆ",ev:["å…¥åœ’å¼","ä¿è­·è€…ä¼š","èº«ä½“æ¸¬å®š"],th:"æ–°ã—ã„ç’°å¢ƒã«æ…£ã‚Œã‚‹"},
  {m:"5æœˆ",ev:["ã“ã©ã‚‚ã®æ—¥ä¼š","é è¶³","æ­¯ç§‘æ¤œè¨º"],th:"å‹é”ã¨éŠã¶æ¥½ã—ã•ã‚’çŸ¥ã‚‹"},
  {m:"6æœˆ",ev:["æ™‚ã®è¨˜å¿µæ—¥","ãƒ—ãƒ¼ãƒ«é–‹ã","ä¿è‚²å‚è¦³"],th:"æ°´éŠã³ã‚’æ¥½ã—ã‚€"},
  {m:"7æœˆ",ev:["ä¸ƒå¤•ä¼š","å¤ç¥­ã‚Š","çµ‚æ¥­å¼"],th:"å¤ã®è‡ªç„¶ã«è¦ªã—ã‚€"},
  {m:"8æœˆ",ev:["ãƒ—ãƒ¼ãƒ«éŠã³","ãŠç›†ä¼‘ã¿"],th:"å¤ã‚’æ€ã„åˆ‡ã‚Šæ¥½ã—ã‚€"},
  {m:"9æœˆ",ev:["é˜²ç½è¨“ç·´","ãŠæœˆè¦‹ä¼š","é‹å‹•ä¼šç·´ç¿’"],th:"ä½“ã‚’å‹•ã‹ã™æ¥½ã—ã•"},
  {m:"10æœˆ",ev:["é‹å‹•ä¼š","ãƒãƒ­ã‚¦ã‚£ãƒ³","èŠ‹æ˜ã‚Šé è¶³"],th:"ç§‹ã®è‡ªç„¶ã‚’æ„Ÿã˜ã‚‹"},
  {m:"11æœˆ",ev:["ä¸ƒäº”ä¸‰","ä¿è‚²å‚è¦³","ç™ºè¡¨ä¼šç·´ç¿’"],th:"è¡¨ç¾ã™ã‚‹å–œã³"},
  {m:"12æœˆ",ev:["ç™ºè¡¨ä¼š","ã‚¯ãƒªã‚¹ãƒã‚¹ä¼š","çµ‚æ¥­å¼"],th:"ã¿ã‚“ãªã§æ¥½ã—ã‚€è¡Œäº‹"},
  {m:"1æœˆ",ev:["å§‹æ¥­å¼","ãŠæ­£æœˆéŠã³","ã‚‚ã¡ã¤ã"],th:"æ—¥æœ¬ã®ä¼çµ±ã«è§¦ã‚Œã‚‹"},
  {m:"2æœˆ",ev:["ç¯€åˆ†","ä½œå“å±•","å’åœ’å¼ç·´ç¿’"],th:"æˆé•·ã‚’æŒ¯ã‚Šè¿”ã‚‹"},
  {m:"3æœˆ",ev:["ã²ãªç¥­ã‚Š","å’åœ’å¼","ä¿®äº†å¼"],th:"1å¹´ã®æˆé•·ã‚’ç¥ã†"},
];

// â”€â”€ Chart Components â”€â”€
const SimpleBarChart=({data,dataKey,nameKey,color,height=200,domain,unit=""})=>{
  const max=domain?domain[1]:Math.max(...data.map(d=>d[dataKey]))*1.1;
  const min=domain?domain[0]:0;const range=max-min;
  const ticks=5;const tickVals=Array.from({length:ticks+1},(_,i)=>Math.round(min+range*(i/ticks)));
  return <div style={{height,display:"flex",padding:"10px 0 4px"}}>
    <div style={{width:36,display:"flex",flexDirection:"column",justifyContent:"space-between",paddingBottom:24,paddingTop:4}}>
      {tickVals.slice().reverse().map((v,i)=><div key={i} style={{fontSize:10,color:C.g500,textAlign:"right",lineHeight:"1"}}>{v}{unit}</div>)}
    </div>
    <div style={{flex:1,position:"relative",paddingBottom:24}}>
      <div style={{position:"absolute",inset:"4px 0 24px 0"}}>
        {tickVals.map((v,i)=><div key={i} style={{position:"absolute",left:0,right:0,bottom:(i/ticks)*100+"%",borderBottom:"1px "+(i===0?"solid":"dashed")+" "+C.g200}}/>)}
      </div>
      <div style={{display:"flex",alignItems:"flex-end",gap:6,height:"calc(100% - 24px)",position:"relative",zIndex:1,padding:"4px 8px 0"}}>
        {data.map((d,i)=>{const pct=((d[dataKey]-min)/range)*100;
          return <div key={i} style={{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:4,height:"100%",justifyContent:"flex-end"}}>
            <div style={{fontSize:11,color:C.g700,fontWeight:700}}>{d[dataKey]}{unit}</div>
            <div style={{width:"100%",maxWidth:44,height:pct+"%",minHeight:4,background:"linear-gradient(180deg,"+(color||C.primary)+","+(color||C.primary)+"cc)",borderRadius:"6px 6px 0 0",transition:"height .5s"}}/>
          </div>})}
      </div>
      <div style={{display:"flex",gap:6,padding:"6px 8px 0"}}>
        {data.map((d,i)=><div key={i} style={{flex:1,textAlign:"center",fontSize:11,color:C.g500,fontWeight:600}}>{d[nameKey]}</div>)}
      </div>
    </div>
  </div>;
};

const MultiBarChart=({data,bars,nameKey,height=200})=>{
  const max=Math.max(...bars.flatMap(b=>data.map(d=>d[b.key])))*1.15;
  return <div>
    <div style={{height,display:"flex",alignItems:"flex-end",gap:8,padding:"20px 0 24px"}}>
      {data.map((d,i)=><div key={i} style={{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:4}}>
        <div style={{display:"flex",gap:2,alignItems:"flex-end",height:"100%",width:"100%",justifyContent:"center"}}>
          {bars.map((b,j)=><div key={j} style={{width:Math.max(8,Math.floor(60/bars.length)),height:(d[b.key]/max)*100+"%",minHeight:4,background:b.color,borderRadius:"3px 3px 0 0"}} title={b.name+": "+d[b.key]+"%"}/>)}</div>
        <div style={{fontSize:11,color:C.g500}}>{d[nameKey]}</div></div>)}
    </div>
    <div style={{display:"flex",gap:12,justifyContent:"center",flexWrap:"wrap"}}>
      {bars.map((b,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:4,fontSize:11,color:C.g500}}>
        <div style={{width:10,height:10,borderRadius:2,background:b.color}}/>{b.name}</div>)}</div>
  </div>;
};

const LineChartSVG=({data,lines,nameKey,height=220,showDots=true})=>{
  const svgW=600,svgH=height-40;
  const pad={t:15,r:15,b:30,l:45};
  const cw=svgW-pad.l-pad.r,ch=svgH-pad.t-pad.b;
  return <div style={{width:"100%",overflow:"hidden"}}>
    <svg viewBox={"0 0 "+svgW+" "+svgH} style={{width:"100%",height}}>
      {[0,.25,.5,.75,1].map((f,i)=><line key={i} x1={pad.l} y1={pad.t+ch*f} x2={svgW-pad.r} y2={pad.t+ch*f} stroke={C.g200} strokeDasharray="4 4"/>)}
      {lines.map((line,li)=>{
        const vals=data.map(d=>d[line.key]);
        const yMin=line.min!==undefined?line.min:Math.min(...vals)*0.95;
        const yMax=line.max!==undefined?line.max:Math.max(...vals)*1.05;
        const yR=yMax-yMin||1;
        const pts=data.map((d,i)=>({x:pad.l+(i/(data.length-1||1))*cw,y:pad.t+ch-((d[line.key]-yMin)/yR)*ch}));
        const area=line.fill?pts.map((p,i)=>(i===0?"M":"L")+p.x+","+p.y).join(" ")+" L"+pts[pts.length-1].x+","+(pad.t+ch)+" L"+pts[0].x+","+(pad.t+ch)+" Z":"";
        return <g key={li}>
          {area&&<path d={area} fill={line.color} fillOpacity=".12"/>}
          <polyline points={pts.map(p=>p.x+","+p.y).join(" ")} fill="none" stroke={line.color} strokeWidth="2.5" strokeLinejoin="round" strokeLinecap="round"/>
          {showDots&&data.length<=31&&pts.map((p,i)=><circle key={i} cx={p.x} cy={p.y} r="3" fill="#fff" stroke={line.color} strokeWidth="2"/>)}
        </g>;
      })}
      {data.map((d,i)=>{
        const show=data.length<=14||(i%(Math.ceil(data.length/10))===0)||i===data.length-1;
        return show?<text key={i} x={pad.l+(i/(data.length-1||1))*cw} y={svgH-5} textAnchor="middle" fontSize="10" fill={C.g500}>{d[nameKey]}</text>:null;
      })}
    </svg>
    <div style={{display:"flex",gap:16,justifyContent:"center",marginTop:4}}>
      {lines.map((l,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:4,fontSize:12,color:l.color}}>
        <div style={{width:14,height:3,borderRadius:2,background:l.color}}/>â— {l.name}</div>)}</div>
  </div>;
};

// â”€â”€ UI Components â”€â”€
const Badge=({children,color=C.primary,bg})=><span style={{display:"inline-block",padding:"2px 10px",borderRadius:12,fontSize:12,fontWeight:600,color,backgroundColor:bg||color+"18"}}>{children}</span>;
const Card=({children,style,onClick})=><div onClick={onClick} style={{background:"#fff",borderRadius:16,padding:20,boxShadow:"0 1px 3px rgba(0,0,0,.08)",cursor:onClick?"pointer":"default",transition:"transform .15s, box-shadow .15s",...style}} onMouseEnter={e=>{if(onClick){e.currentTarget.style.transform="translateY(-2px)";e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,.12)"}}} onMouseLeave={e=>{if(onClick){e.currentTarget.style.transform="translateY(0)";e.currentTarget.style.boxShadow="0 1px 3px rgba(0,0,0,.08)"}}}>{children}</div>;
const Btn=({children,onClick,v="primary",sz="md",style:s,disabled})=>{
  const vs={primary:{background:"linear-gradient(135deg,"+C.primary+","+C.primaryDark+")",color:"#fff",border:"none"},
    secondary:{background:"#fff",color:C.g700,border:"1px solid "+C.g200},
    accent:{background:"linear-gradient(135deg,"+C.accent+",#D97706)",color:"#fff",border:"none"},
    danger:{background:"linear-gradient(135deg,"+C.danger+",#DC2626)",color:"#fff",border:"none"}};
  const szs={sm:{padding:"6px 14px",fontSize:13},md:{padding:"10px 20px",fontSize:14},lg:{padding:"14px 28px",fontSize:16}};
  return <button onClick={disabled?null:onClick} style={{...vs[v],...szs[sz],borderRadius:10,fontWeight:600,cursor:disabled?"not-allowed":"pointer",opacity:disabled?.5:1,transition:"all .15s",display:"inline-flex",alignItems:"center",gap:6,...s}}>{children}</button>;
};
const Sec=({icon,title,sub})=><div style={{marginBottom:16}}><h2 style={{fontSize:20,fontWeight:700,color:C.g900,margin:0,display:"flex",alignItems:"center",gap:8}}><span style={{fontSize:24}}>{icon}</span>{title}</h2>{sub&&<p style={{fontSize:13,color:C.g500,margin:"4px 0 0 32px"}}>{sub}</p>}</div>;
const Prog=({value,color=C.primary,h=8})=><div style={{background:C.g100,borderRadius:h,height:h,width:"100%",overflow:"hidden"}}><div style={{background:color,height:"100%",width:value+"%",borderRadius:h,transition:"width .5s"}}/></div>;
const AITag=()=><span style={{display:"inline-flex",alignItems:"center",gap:4,padding:"3px 10px",borderRadius:20,background:"linear-gradient(135deg,#10B981,#3B82F6)",color:"#fff",fontSize:11,fontWeight:700}}>AIç”Ÿæˆ</span>;
const Toast=({msg,type="success"})=>msg?<div className="toast" style={{background:type==="success"?"linear-gradient(135deg,#10B981,#059669)":type==="info"?"linear-gradient(135deg,#3B82F6,#2563EB)":"linear-gradient(135deg,#F59E0B,#D97706)"}}>{msg}</div>:null;
const TabBar=({tabs,cur,setCur})=><div style={{display:"flex",gap:4,marginBottom:16,background:C.g100,borderRadius:10,padding:3}}>
  {tabs.map(t=><div key={t.id} onClick={()=>setCur(t.id)} style={{flex:1,padding:"8px 12px",borderRadius:8,textAlign:"center",fontSize:13,fontWeight:600,cursor:"pointer",transition:"all .2s",background:cur===t.id?C.primary:"transparent",color:cur===t.id?"#fff":C.g500}}>{t.label}</div>)}</div>;

// â”€â”€ Login Flow: Role Selection â†’ Login â”€â”€
const RoleSelectScreen=({onSelectRole})=><div style={{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg,#064E3B 0%,#065F46 40%,#047857 100%)"}}>
  <div style={{textAlign:"center",animation:"fadeIn .4s ease"}}>
    <div style={{fontSize:72,marginBottom:8}}>ğŸŒ±</div>
    <h1 style={{color:"#fff",fontSize:42,fontWeight:800,margin:0,letterSpacing:2}}>ãã ã¡AI</h1>
    <p style={{color:"#A7F3D0",fontSize:16,marginTop:8,marginBottom:40,letterSpacing:1}}>SODACHI AI â€” AIãƒã‚¤ãƒ†ã‚£ãƒ–ä¿è‚²ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
    <p style={{color:"rgba(255,255,255,.6)",fontSize:14,marginBottom:24}}>ã”åˆ©ç”¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„</p>
    <div style={{display:"flex",gap:16,justifyContent:"center",flexWrap:"wrap"}}>
      {[{role:"teacher",icon:"ğŸ‘©â€ğŸ«",label:"ä¿è‚²å£«",sub:"æ—¥å¸¸æ¥­å‹™ãƒ»è¨˜éŒ²ãƒ»é€£çµ¡å¸³"},
        {role:"director",icon:"ğŸ‘¨â€ğŸ’¼",label:"åœ’é•·ãƒ»ç®¡ç†è€…",sub:"çµŒå–¶ç®¡ç†ãƒ»è¨ˆç”»ãƒ»åˆ†æ"},
        {role:"parent",icon:"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§",label:"ä¿è­·è€…",sub:"ç™»é™åœ’ãƒ»é€£çµ¡å¸³ãƒ»å†™çœŸ"}
      ].map(r=><div key={r.role} onClick={()=>onSelectRole(r.role)} style={{
        background:"rgba(255,255,255,.1)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,.2)",
        borderRadius:20,padding:"32px 28px",width:200,cursor:"pointer",transition:"all .2s",textAlign:"center"}}
        onMouseEnter={e=>{e.currentTarget.style.background="rgba(255,255,255,.2)";e.currentTarget.style.transform="translateY(-4px)"}}
        onMouseLeave={e=>{e.currentTarget.style.background="rgba(255,255,255,.1)";e.currentTarget.style.transform="translateY(0)"}}>
        <div style={{fontSize:48}}>{r.icon}</div>
        <div style={{color:"#fff",fontSize:20,fontWeight:700,marginTop:12}}>{r.label}</div>
        <div style={{color:"#A7F3D0",fontSize:12,marginTop:6}}>{r.sub}</div>
      </div>)}
    </div>
    <p style={{color:"rgba(255,255,255,.3)",fontSize:12,marginTop:40}}>Powered by æ ªå¼ä¼šç¤¾ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—NeXt Ã— å¯Œå£«ãƒ•ã‚¤ãƒ«ãƒ ãƒ“ã‚¸ãƒã‚¹ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚¸ãƒ£ãƒ‘ãƒ³</p>
  </div>
</div>;

const LoginScreen=({role,onLogin,onBack})=>{
  const[email,setEmail]=useState("");const[pw,setPw]=useState("");
  const[error,setError]=useState("");const[shaking,setShaking]=useState(false);
  const rl=role==="teacher"?"ä¿è‚²å£«":role==="parent"?"ä¿è­·è€…":"åœ’é•·ãƒ»ç®¡ç†è€…";
  const ri=role==="teacher"?"ğŸ‘©â€ğŸ«":role==="parent"?"ğŸ‘¨â€ğŸ‘©â€ğŸ‘§":"ğŸ‘¨â€ğŸ’¼";
  const handleSubmit=e=>{e.preventDefault();
    const user=USERS.find(u=>u.email===email);
    if(user&&pw===PW){setError("");onLogin(user)}
    else{setError("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“");setShaking(true);setTimeout(()=>setShaking(false),500)}};
  return <div style={{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg,#064E3B 0%,#065F46 40%,#047857 100%)"}}>
    <div style={{textAlign:"center",width:420}}>
      <div style={{fontSize:48,marginBottom:4}}>{ri}</div>
      <h1 style={{color:"#fff",fontSize:32,fontWeight:800,margin:0}}>{rl}ãƒ­ã‚°ã‚¤ãƒ³</h1>
      <p style={{color:"#A7F3D0",fontSize:14,marginTop:8,marginBottom:32}}>ãã ã¡AI â€” {rl}ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</p>
      <div className={shaking?"shake":""} style={{background:"rgba(255,255,255,.1)",backdropFilter:"blur(10px)",border:"1px solid rgba(255,255,255,.2)",borderRadius:20,padding:"36px 32px",textAlign:"left"}}>
        <form onSubmit={handleSubmit}>
          <label style={{display:"block",color:"rgba(255,255,255,.8)",fontSize:13,fontWeight:600,marginBottom:6}}>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
          <input type="email" value={email} onChange={e=>setEmail(e.target.value)} placeholder="name@example.com" style={{width:"100%",padding:"12px 16px",borderRadius:10,border:"1px solid rgba(255,255,255,.3)",background:"rgba(255,255,255,.08)",color:"#fff",fontSize:15,marginBottom:16}}/>
          <label style={{display:"block",color:"rgba(255,255,255,.8)",fontSize:13,fontWeight:600,marginBottom:6}}>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
          <input type="password" value={pw} onChange={e=>setPw(e.target.value)} placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›" style={{width:"100%",padding:"12px 16px",borderRadius:10,border:"1px solid rgba(255,255,255,.3)",background:"rgba(255,255,255,.08)",color:"#fff",fontSize:15,marginBottom:8}}/>
          {error&&<div style={{color:"#FCA5A5",fontSize:13,marginBottom:12,padding:"8px 12px",background:"rgba(239,68,68,.15)",borderRadius:8}}>âš ï¸ {error}</div>}
          <button type="submit" style={{width:"100%",padding:"14px",borderRadius:10,border:"none",background:"linear-gradient(135deg,#10B981,#059669)",color:"#fff",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:8}}>ãƒ­ã‚°ã‚¤ãƒ³</button>
        </form>
      </div>
      <div onClick={onBack} style={{color:"rgba(255,255,255,.5)",fontSize:13,marginTop:20,cursor:"pointer"}}>â† ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¿ã‚¤ãƒ—é¸æŠã«æˆ»ã‚‹</div>
    </div>
  </div>;
};

// â”€â”€ Sidebar â”€â”€
const MENU_T=[{id:"dashboard",icon:"ğŸ“Š",label:"ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"},{id:"attendance",icon:"ğŸ“¸",label:"AIç™»é™åœ’ç®¡ç†"},{id:"journal",icon:"ğŸ“",label:"AIæ—¥èªŒãƒ»é€£çµ¡å¸³"},{id:"plan",icon:"ğŸ“…",label:"AIå¹´é–“è¨ˆç”»"},{id:"event",icon:"ğŸª",label:"AIã‚¤ãƒ™ãƒ³ãƒˆä¼ç”»"},{id:"meal",icon:"ğŸ±",label:"é£Ÿäº‹ãƒ»ç”Ÿæ´»è¨˜éŒ²"},{id:"vital",icon:"ğŸ’“",label:"ãƒã‚¤ã‚¿ãƒ«ç›£è¦–"},{id:"growth",icon:"ğŸ“ˆ",label:"æˆé•·ç®¡ç†ãƒ»ã‚¢ãƒ«ãƒãƒ "}];
const MENU_P=[{id:"p_home",icon:"ğŸ ",label:"ãƒ›ãƒ¼ãƒ "},{id:"p_timeline",icon:"ğŸ“·",label:"ä»Šæ—¥ã®ã‚ˆã†ã™"},{id:"p_growth",icon:"ğŸ“ˆ",label:"æˆé•·è¨˜éŒ²"}];
const MENU_D=[{id:"d_dashboard",icon:"ğŸ“Š",label:"çµŒå–¶ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰"},{id:"d_staff",icon:"ğŸ‘©â€ğŸ«",label:"è·å“¡ç®¡ç†"},{id:"d_plan",icon:"ğŸ“…",label:"å¹´é–“è¨ˆç”»"}];

const Sidebar=({role,cur,setPage,onLogout,userName})=>{
  const menus=role==="teacher"?MENU_T:role==="parent"?MENU_P:MENU_D;
  const rl=role==="teacher"?"ä¿è‚²å£«":role==="parent"?"ä¿è­·è€…":"åœ’é•·";
  return <div style={{width:240,minHeight:"100vh",background:"linear-gradient(180deg,#064E3B,#065F46)",color:"#fff",padding:"20px 0",flexShrink:0,display:"flex",flexDirection:"column"}}>
    <div style={{padding:"0 20px 16px",borderBottom:"1px solid rgba(255,255,255,.1)"}}>
      <div style={{fontSize:22,fontWeight:800,letterSpacing:1}}>ğŸŒ± ãã ã¡AI</div>
      <div style={{fontSize:11,opacity:.7,marginTop:4}}>{rl}ãƒ“ãƒ¥ãƒ¼</div>
      <div style={{fontSize:12,opacity:.5,marginTop:2}}>{userName}</div>
    </div>
    <nav style={{padding:"12px 0",flex:1}}>
      {menus.map(m=><div key={m.id} onClick={()=>setPage(m.id)} style={{padding:"12px 20px",cursor:"pointer",display:"flex",alignItems:"center",gap:10,background:cur===m.id?"rgba(255,255,255,.15)":"transparent",borderLeft:cur===m.id?"3px solid #34D399":"3px solid transparent",transition:"all .15s",fontSize:14,fontWeight:cur===m.id?600:400}}
        onMouseEnter={e=>{if(cur!==m.id)e.currentTarget.style.background="rgba(255,255,255,.08)"}}
        onMouseLeave={e=>{if(cur!==m.id)e.currentTarget.style.background="transparent"}}>
        <span style={{fontSize:18}}>{m.icon}</span>{m.label}</div>)}
    </nav>
    <div style={{padding:"12px 20px",borderTop:"1px solid rgba(255,255,255,.1)"}}>
      <div onClick={onLogout} style={{padding:"8px 12px",borderRadius:8,cursor:"pointer",fontSize:13,textAlign:"center",background:"rgba(255,255,255,.08)"}} onMouseEnter={e=>e.currentTarget.style.background="rgba(255,255,255,.15)"} onMouseLeave={e=>e.currentTarget.style.background="rgba(255,255,255,.08)"}>ğŸšª ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</div>
      <div style={{fontSize:11,opacity:.4,textAlign:"center",marginTop:8}}>Â© 2026 ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—NeXt</div>
    </div>
  </div>;
};

// â”€â”€ Detail Modal â”€â”€
const DetailModal=({title,icon,children,onClose})=><div className="modal-overlay" onClick={onClose}>
  <div className="modal-box" onClick={e=>e.stopPropagation()}>
    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20}}>
      <h2 style={{fontSize:20,fontWeight:700,display:"flex",alignItems:"center",gap:8,margin:0}}><span style={{fontSize:28}}>{icon}</span>{title}</h2>
      <div onClick={onClose} style={{width:36,height:36,borderRadius:"50%",background:C.g100,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:18}}>âœ•</div>
    </div>
    {children}
  </div></div>;

// â”€â”€ AI Suggest Detail Pages â”€â”€
const SuggestContact=({onBack})=><div>
  <div onClick={onBack} style={{cursor:"pointer",fontSize:13,color:C.primary,marginBottom:16}}>â† ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</div>
  <Card style={{marginBottom:16}}>
    <Sec icon="ğŸ“" title="ä¿è­·è€…é€£çµ¡ â€” ä¼Šè—¤ãã†ãŸãã‚“" sub="æœªç™»åœ’ã®ãŸã‚ç¢ºèªé€£çµ¡"/>
    <div style={{background:C.accentLight,borderRadius:12,padding:16,marginBottom:16}}>
      <div style={{fontSize:13,fontWeight:700,color:C.g900,marginBottom:8}}>âš ï¸ çŠ¶æ³</div>
      <div style={{fontSize:13,color:C.g700}}>ä¼Šè—¤ãã†ãŸãã‚“ï¼ˆ4æ­³ãƒ»ã²ã¾ã‚ã‚Šçµ„ï¼‰ã¯æœ¬æ—¥ 9:30 æ™‚ç‚¹ã§ç™»åœ’ãŒã‚ã‚Šã¾ã›ã‚“ã€‚æ¬ å¸­é€£çµ¡ã‚‚å±Šã„ã¦ã„ã¾ã›ã‚“ã€‚</div></div>
    <div style={{marginBottom:16}}>
      <div style={{fontSize:13,fontWeight:700,marginBottom:8}}>ğŸ“‹ ä¿è­·è€…æƒ…å ±</div>
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}}>
        <div style={{fontSize:13,color:C.g700}}>ä¿è­·è€…ï¼šä¼Šè—¤ ç¾ç©‚ï¼ˆæ¯ï¼‰</div>
        <div style={{fontSize:13,color:C.g700}}>é€£çµ¡å…ˆï¼š090-1234-5678</div>
        <div style={{fontSize:13,color:C.g700}}>ç·Šæ€¥é€£çµ¡å…ˆï¼šä¼Šè—¤ å¤§è¼”ï¼ˆçˆ¶ï¼‰</div>
        <div style={{fontSize:13,color:C.g700}}>é€£çµ¡å…ˆï¼š090-8765-4321</div></div></div>
    <AITag/><div style={{fontSize:13,color:C.g700,marginTop:8,lineHeight:1.8,background:C.g50,borderRadius:10,padding:14}}>
      <div style={{fontWeight:700,marginBottom:4}}>AIç”Ÿæˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ¡ˆï¼š</div>
      ã€ŒãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚ã²ã¾ã‚ã‚Šçµ„ã®æ‹…ä»»ã§ã™ã€‚æœ¬æ—¥ã€ãã†ãŸãã‚“ã®ç™»åœ’ãŒã¾ã ç¢ºèªã§ãã¦ãŠã‚Šã¾ã›ã‚“ã€‚ã”ä½“èª¿ãªã©å¤‰ã‚ã‚Šã”ã–ã„ã¾ã›ã‚“ã§ã—ã‚‡ã†ã‹ã€‚ãŠæ‰‹æ•°ã§ã™ãŒã”é€£çµ¡ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚ã€</div>
    <div style={{display:"flex",gap:8,marginTop:16}}>
      <Btn onClick={onBack}>ğŸ“± ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é€£çµ¡ã™ã‚‹</Btn>
      <Btn v="secondary">âœï¸ ç·¨é›†ã—ã¦é€£çµ¡ã™ã‚‹</Btn></div>
  </Card></div>;

const SuggestJournal=({onBack})=><div>
  <div onClick={onBack} style={{cursor:"pointer",fontSize:13,color:C.primary,marginBottom:16}}>â† ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</div>
  <Card style={{marginBottom:16}}>
    <Sec icon="ğŸ“" title="AIæ—¥èªŒãƒ‰ãƒ©ãƒ•ãƒˆ â€” ç”°ä¸­ã‚†ã†ã¨ãã‚“" sub="AIãŒè‡ªå‹•ç”Ÿæˆã—ãŸæ—¥èªŒã‚’ç¢ºèª"/>
    <AITag/><div style={{marginTop:12,fontSize:13,lineHeight:1.9,color:C.g700,background:C.g50,borderRadius:12,padding:16}}>
      <div style={{fontWeight:700,color:C.g900,marginBottom:8}}>ğŸŒŸ ä»Šæ—¥ã®æ´»å‹•è¨˜éŒ²</div>
      ä»Šæ—¥ã®ã‚†ã†ã¨ãã‚“ã¯ã€æœã®è‡ªç”±éŠã³ã®æ™‚é–“ã«ãƒ–ãƒ­ãƒƒã‚¯ã§å¤§ããªãŠåŸã‚’ä½œã£ã¦ã„ã¾ã—ãŸã€‚ã€Œå…ˆç”Ÿã€è¦‹ã¦ï¼ãŠåŸã§ããŸã‚ˆï¼ã€ã¨å¬‰ã—ãã†ã«æ•™ãˆã¦ãã‚Œã¾ã—ãŸã€‚<br/><br/>
      ãŠçµµæãã®æ™‚é–“ã«ã¯ã€ã‚¯ãƒ¬ãƒ¨ãƒ³ã‚’ä½¿ã£ã¦å®¶æ—ã®çµµã‚’æãã¾ã—ãŸã€‚ã€Œã“ã‚Œã¯ãƒ‘ãƒ‘ã€ã“ã‚Œã¯ãƒãƒã€ã“ã‚Œã¯ã¼ãï¼ã€ã¨ä¸€ã¤ã²ã¨ã¤èª¬æ˜ã—ã¦ãã‚Œã¾ã—ãŸã€‚<br/><br/>
      å¤–éŠã³ã§ã¯ã€ä½è—¤ã‚ãŠã„ã¡ã‚ƒã‚“ã¨ä¸€ç·’ã«ç ‚å ´ã§éŠã³ã€å±±ã‚’ä½œã£ã¦æ¥½ã—ã‚“ã§ã„ã¾ã—ãŸã€‚<br/><br/>
      <div style={{fontWeight:700,color:C.g900,marginTop:12,marginBottom:4}}>ğŸ± çµ¦é£Ÿ</div>
      ã”ã¯ã‚“ 90%ãƒ»ä¸»èœ 80%ãƒ»å‰¯èœ 70%ãƒ»ã‚¹ãƒ¼ãƒ— 100%ã€‚ãŠã‹ã‚ã‚Š1å›ã€‚<br/><br/>
      <div style={{fontWeight:700,color:C.g900,marginTop:12,marginBottom:4}}>ğŸ’¤ åˆç¡</div>
      12:50ã€œ14:45ï¼ˆ1æ™‚é–“55åˆ†ï¼‰ã€‚ã™ãã«å…¥çœ ã—ã€ãã£ã™ã‚Šçœ ã‚Šã¾ã—ãŸã€‚<br/><br/>
      <div style={{fontWeight:700,color:C.g900,marginTop:12,marginBottom:4}}>ğŸ“¸ AIé¸å®šå†™çœŸï¼ˆ3æšï¼‰</div>
      <div style={{display:"flex",gap:8,marginTop:4}}>{[{e:"ğŸ¨",bg:"#FFE4C4",l:"ãŠçµµæã"},{e:"ğŸ—",bg:"#B0E0E6",l:"ãƒ–ãƒ­ãƒƒã‚¯"},{e:"â›±",bg:"#F0E68C",l:"ç ‚å ´"}].map((p,i)=>
        <div key={i} style={{width:80,height:60,borderRadius:8,background:"linear-gradient(135deg,"+p.bg+",#fff)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:24,border:"1px solid "+C.g200}}>{p.e}</div>)}</div>
    </div>
    <div style={{display:"flex",gap:8,marginTop:16}}>
      <Btn onClick={onBack}>âœ… æ‰¿èªã™ã‚‹</Btn>
      <Btn v="secondary">âœï¸ ä¿®æ­£ã™ã‚‹</Btn>
      <Btn v="accent">ğŸ”„ AIå†ç”Ÿæˆ</Btn></div>
  </Card></div>;

const SuggestEvent=({onBack})=><div>
  <div onClick={onBack} style={{cursor:"pointer",fontSize:13,color:C.primary,marginBottom:16}}>â† ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹</div>
  <Card style={{marginBottom:16}}>
    <Sec icon="ğŸ‘¹" title="ç¯€åˆ†ã‚¤ãƒ™ãƒ³ãƒˆ ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ¡ˆ" sub="æ¥é€± 2/3ï¼ˆç«ï¼‰å®Ÿæ–½äºˆå®š"/>
    <AITag/><div style={{marginTop:12}}>
      <div style={{display:"grid",gap:12}}>
        {[{time:"10:00",act:"ã¯ã˜ã‚ã®è¨€è‘‰ãƒ»ç¯€åˆ†ã®ãŠè©±",detail:"åœ’é•·å…ˆç”Ÿã‹ã‚‰ç¯€åˆ†ã®ç”±æ¥ã«ã¤ã„ã¦ã®ãŠè©±ã€‚ç´™èŠå±…ã€ŒãŠã«ã¯ãã¨ã€ã‚’ä½¿ç”¨ã€‚",who:"åœ’é•·ãƒ»æ‹…ä»»"},
          {time:"10:15",act:"è±†ã¾ãã®æ­Œãƒ»æ‰‹éŠã³",detail:"ã€Œã¾ã‚ã¾ãã€ã‚’å…¨å“¡ã§æ­Œã„ã¾ã™ã€‚é¬¼ã®ãƒ‘ãƒ³ãƒ„ã®æ‰‹éŠã³ã‚‚ã€‚",who:"éŸ³æ¥½æ‹…å½“"},
          {time:"10:30",act:"é¬¼ç™»å ´ï¼è±†ã¾ã",detail:"è·å“¡2åãŒé¬¼å½¹ã€‚å„çµ„ã”ã¨ã«æ–°èç´™ã®è±†ã§è±†ã¾ãã€‚ã€Œé¬¼ã¯å¤–ï¼ç¦ã¯å†…ï¼ã€",who:"å…¨è·å“¡"},
          {time:"10:50",act:"æµæ–¹å·»ãè£½ä½œ",detail:"æŠ˜ã‚Šç´™ã§æµæ–¹å·»ãã‚’ä½œã‚Šã¾ã™ã€‚ä»Šå¹´ã®æ–¹è§’ï¼ˆå—å—æ±ï¼‰ã®ãŠè©±ã‚‚ã€‚",who:"æ‹…ä»»"},
          {time:"11:10",act:"è¨˜å¿µæ’®å½±ãƒ»ãŠã‚ã‚Šã®è¨€è‘‰",detail:"é¬¼ã®ãŠé¢ã‚’ã¤ã‘ã¦ã‚¯ãƒ©ã‚¹ã”ã¨ã«è¨˜å¿µæ’®å½±ã€‚",who:"æ‹…ä»»ãƒ»ãƒ•ãƒªãƒ¼"},
          {time:"12:00",act:"ç‰¹åˆ¥çµ¦é£Ÿï¼šé¬¼ã•ã‚“ã‚«ãƒ¬ãƒ¼",detail:"é¬¼ã®é¡”ã‚’ãƒ¢ãƒãƒ¼ãƒ•ã«ã—ãŸã‚«ãƒ¬ãƒ¼ãƒ©ã‚¤ã‚¹ã€‚ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å¯¾å¿œã‚ã‚Šã€‚",who:"çµ¦é£Ÿå®¤"}
        ].map((ev,i)=><div key={i} style={{display:"flex",gap:12,padding:12,background:C.g50,borderRadius:10}}>
          <div style={{minWidth:50,fontSize:13,fontWeight:700,color:C.primary}}>{ev.time}</div>
          <div style={{flex:1}}><div style={{fontSize:14,fontWeight:700,color:C.g900}}>{ev.act}</div>
            <div style={{fontSize:12,color:C.g700,marginTop:2}}>{ev.detail}</div>
            <div style={{fontSize:11,color:C.g500,marginTop:4}}>æ‹…å½“: {ev.who}</div></div></div>)}
      </div>
      <div style={{marginTop:16,padding:12,background:C.accentLight,borderRadius:10}}>
        <div style={{fontSize:13,fontWeight:700,color:C.g900}}>ğŸ“ æº–å‚™ç‰©ãƒªã‚¹ãƒˆ</div>
        <div style={{fontSize:12,color:C.g700,marginTop:4}}>æ–°èç´™ï¼ˆè±†ç”¨ï¼‰ãƒ»é¬¼ã®ãŠé¢ã‚­ãƒƒãƒˆãƒ»æŠ˜ã‚Šç´™ï¼ˆæµæ–¹å·»ãç”¨ï¼‰ãƒ»é¬¼ã®ã‚³ã‚¹ãƒãƒ¥ãƒ¼ãƒ Ã—2ãƒ»ç´™èŠå±…ã€ŒãŠã«ã¯ãã¨ã€ãƒ»è¨˜å¿µæ’®å½±ç”¨èƒŒæ™¯</div></div>
    </div>
    <div style={{display:"flex",gap:8,marginTop:16}}>
      <Btn onClick={onBack}>âœ… ã“ã®æ¡ˆã§æ±ºå®š</Btn>
      <Btn v="secondary">âœï¸ ä¿®æ­£ã™ã‚‹</Btn>
      <Btn v="accent">ğŸ”„ AIå†ç”Ÿæˆ</Btn>
      <Btn v="secondary">ğŸ“„ PDFå‡ºåŠ›</Btn></div>
  </Card></div>;

// â”€â”€ Teacher Dashboard â”€â”€
const TeacherDash=({userName})=>{
  const[vm,setVm]=useState(false);const[modal,setModal]=useState(null);const[subPage,setSubPage]=useState(null);
  const ac=CHILDREN.filter(c=>c.arrived).length;const absent=CHILDREN.filter(c=>!c.arrived);
  const arrived=CHILDREN.filter(c=>c.arrived);

  // Detail data for each card popup
  const cardDetails={
    attendance:{icon:"ğŸ‘¶",title:"å‡ºå¸­çŠ¶æ³ è©³ç´°",content:<div>
      <div style={{fontWeight:700,fontSize:14,color:C.primary,marginBottom:12}}>âœ… å‡ºå¸­ï¼ˆ{arrived.length}åï¼‰</div>
      {arrived.map((c,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0",borderBottom:"1px solid "+C.g100}}>
        <span style={{fontSize:22}}>{c.photo}</span><div style={{flex:1}}><div style={{fontSize:13,fontWeight:600}}>{c.name}</div><div style={{fontSize:11,color:C.g500}}>{c.cls}ãƒ»{c.age}æ­³</div></div>
        <div style={{fontSize:12,color:C.primary}}>ğŸ• {c.time}ï¼ˆ{c.parent}é€ã‚Šï¼‰</div></div>)}
      <div style={{fontWeight:700,fontSize:14,color:C.danger,marginTop:16,marginBottom:12}}>âŒ æœªç™»åœ’ï¼ˆ{absent.length}åï¼‰</div>
      {absent.map((c,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:10,padding:"8px 0"}}>
        <span style={{fontSize:22}}>{c.photo}</span><div><div style={{fontSize:13,fontWeight:600}}>{c.name}</div><div style={{fontSize:11,color:C.g500}}>{c.cls}ãƒ»{c.age}æ­³</div></div>
        <Badge color={C.danger}>é€£çµ¡ãªã—</Badge></div>)}
    </div>},
    journal:{icon:"ğŸ“",title:"AIæ—¥èªŒ æ‰¿èªå¾…ã¡",content:<div>
      {[{n:"ç”°ä¸­ ã‚†ã†ã¨",s:"ãƒ–ãƒ­ãƒƒã‚¯éŠã³ãƒ»ãŠçµµæããƒ»ç ‚å ´",st:"draft"},{n:"ä½è—¤ ã‚ãŠã„",s:"ãŠèŠ±ã®çµµãƒ»ãƒ–ãƒ©ãƒ³ã‚³ãƒ»çµ¦é£Ÿ",st:"draft"},{n:"éˆ´æœ¨ ã¯ã‚‹ã¨",s:"ç©ã¿æœ¨ã‚¿ãƒ¯ãƒ¼ãƒ»é¬¼ã”ã£ã“ãƒ»çµµæœ¬",st:"draft"},
        {n:"é«˜æ©‹ ã²ãªãŸ",s:"ãŠã¾ã¾ã”ã¨ãƒ»æŠ˜ã‚Šç´™ãƒ»ç²˜åœŸ",st:"draft"},{n:"æ¸¡è¾º ã‚ã„",s:"ã‚¿ãƒ³ãƒãƒªãƒ³ãƒ»æ°´ãŸã¾ã‚Šãƒ»ãƒªã‚ºãƒ éŠã³",st:"draft"}].map((j,i)=>
        <div key={i} style={{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid "+C.g100}}>
          <div><div style={{fontSize:14,fontWeight:600}}>{j.n}</div><div style={{fontSize:12,color:C.g500,marginTop:2}}>{j.s}</div></div>
          <div style={{display:"flex",gap:6}}><Badge color={C.info}>AIç”Ÿæˆæ¸ˆ</Badge><Btn v="secondary" sz="sm">ç¢ºèª</Btn></div></div>)}
    </div>},
    vital:{icon:"ğŸ’“",title:"ãƒã‚¤ã‚¿ãƒ«çŠ¶æ³ ä¸€è¦§",content:<div>
      {arrived.map((c,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:10,padding:"10px 0",borderBottom:"1px solid "+C.g100}}>
        <span style={{fontSize:22}}>{c.photo}</span><div style={{flex:1}}><div style={{fontSize:13,fontWeight:600}}>{c.name}</div></div>
        <div style={{display:"flex",gap:12,fontSize:12}}>
          <span>â¤ï¸ {c.hr}bpm</span><span>ğŸ« SpOâ‚‚ {c.spo2}%</span><span>ğŸŒ¡ {c.temp}â„ƒ</span>
        </div><Badge color={C.primary}>æ­£å¸¸</Badge></div>)}
    </div>},
    alert:{icon:"âš ï¸",title:"ã‚¢ãƒ©ãƒ¼ãƒˆè©³ç´°",content:<div>
      <div style={{background:C.accentLight,borderRadius:12,padding:16,marginBottom:12}}>
        <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:8}}><Badge color={C.accent}>æœªå¯¾å¿œ</Badge><span style={{fontSize:13,fontWeight:700}}>æœªç™»åœ’ã‚¢ãƒ©ãƒ¼ãƒˆ</span></div>
        <div style={{fontSize:13,color:C.g700}}>ä¼Šè—¤ãã†ãŸãã‚“ï¼ˆ4æ­³ãƒ»ã²ã¾ã‚ã‚Šçµ„ï¼‰ãŒ 9:30 æ™‚ç‚¹ã§ç™»åœ’ç¢ºèªã§ãã¦ã„ã¾ã›ã‚“ã€‚æ¬ å¸­é€£çµ¡ã‚‚å±Šã„ã¦ã„ã¾ã›ã‚“ã€‚</div>
        <div style={{display:"flex",gap:8,marginTop:12}}><Btn sz="sm">ğŸ“ ä¿è­·è€…ã«é€£çµ¡</Btn><Btn v="secondary" sz="sm">âœ“ å¯¾å¿œæ¸ˆã¿ã«ã™ã‚‹</Btn></div></div>
      <div style={{fontSize:13,fontWeight:700,color:C.g700,marginTop:16,marginBottom:8}}>éå»ã®ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆå¯¾å¿œæ¸ˆã¿ï¼‰</div>
      {[{t:"2/14 ä½è—¤ã‚ãŠã„ ä½“æ¸© 37.8â„ƒ",r:"ä¿è­·è€…é€£çµ¡æ¸ˆãƒ»æ—©é€€"},{t:"2/12 éˆ´æœ¨ã¯ã‚‹ã¨ åˆç¡ä¸­ SpOâ‚‚ ä½ä¸‹",r:"ä½“ä½å¤‰æ›´ã§å›å¾©"}].map((a,i)=>
        <div key={i} style={{padding:"8px 0",borderBottom:"1px solid "+C.g100,fontSize:12}}>
          <div style={{color:C.g700}}>{a.t}</div><div style={{color:C.g500}}>å¯¾å¿œ: {a.r}</div></div>)}
    </div>}
  };

  if(subPage==="contact")return <SuggestContact onBack={()=>setSubPage(null)}/>;
  if(subPage==="journal")return <SuggestJournal onBack={()=>setSubPage(null)}/>;
  if(subPage==="event")return <SuggestEvent onBack={()=>setSubPage(null)}/>;

  return <div>
    {modal&&<DetailModal icon={cardDetails[modal].icon} title={cardDetails[modal].title} onClose={()=>setModal(null)}>{cardDetails[modal].content}</DetailModal>}
    <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24}}>
      <div><h1 style={{fontSize:24,fontWeight:800,color:C.g900,margin:0}}>{userName?userName+"ã•ã‚“ã€":""}ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ ğŸ‘‹</h1>
        <p style={{color:C.g500,margin:"4px 0 0",fontSize:14}}>2026å¹´2æœˆ17æ—¥ï¼ˆç«ï¼‰ï½œã²ã¾ã‚ã‚Šçµ„</p></div>
      <Btn v={vm?"danger":"accent"} onClick={()=>setVm(!vm)}>{vm?"â¹ éŒ²éŸ³åœæ­¢":"ğŸ¤ éŸ³å£°ãƒ¡ãƒ¢"}</Btn></div>
    {vm&&<Card style={{background:"linear-gradient(135deg,#FEF3C7,#FDE68A)",marginBottom:16,border:"1px solid #F59E0B"}}>
      <div style={{display:"flex",alignItems:"center",gap:12}}>
        <div style={{width:12,height:12,borderRadius:"50%",background:C.danger,animation:"pulse 1.5s infinite"}}/>
        <div><div style={{fontWeight:700,fontSize:14,color:C.g900}}>éŸ³å£°ãƒ¡ãƒ¢éŒ²éŸ³ä¸­...</div>
          <div style={{fontSize:12,color:C.g700}}>AIãŒè‡ªå‹•ã§ãƒ†ã‚­ã‚¹ãƒˆåŒ–ã—æ—¥èªŒç´ æã«ç™»éŒ²ã—ã¾ã™</div></div></div></Card>}
    <div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:20}}>
      {[{icon:"ğŸ‘¶",l:"å‡ºå¸­",v:ac+"/"+CHILDREN.length+"å",c:C.primary,k:"attendance"},{icon:"ğŸ“",l:"AIæ—¥èªŒ",v:"5ä»¶ æ‰¿èªå¾…ã¡",c:C.info,k:"journal"},{icon:"ğŸ’“",l:"ãƒã‚¤ã‚¿ãƒ«",v:"å…¨å“¡æ­£å¸¸",c:C.primary,k:"vital"},{icon:"âš ï¸",l:"ã‚¢ãƒ©ãƒ¼ãƒˆ",v:"1ä»¶",c:C.accent,k:"alert"}].map((k,i)=>
        <Card key={i} onClick={()=>setModal(k.k)} style={{cursor:"pointer"}}><div style={{fontSize:28}}>{k.icon}</div><div style={{fontSize:12,color:C.g500,marginTop:8}}>{k.l}</div><div style={{fontSize:18,fontWeight:700,color:k.c,marginTop:2}}>{k.v}</div>
          <div style={{fontSize:11,color:C.primary,marginTop:6}}>è©³ç´°ã‚’è¦‹ã‚‹ â†’</div></Card>)}</div>
    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>
      <Card><Sec icon="âœ¨" title="AIã‚µã‚¸ã‚§ã‚¹ãƒˆ" sub="ãã ã¡AIã‹ã‚‰ã®ææ¡ˆ"/>
        {[{t:"ä¼Šè—¤ãã†ãŸãã‚“ï¼ˆæœªç™»åœ’ï¼‰ã®ä¿è­·è€…ã«ç¢ºèªé€£çµ¡ã‚’é€ã‚Šã¾ã™ã‹ï¼Ÿ",tp:"w",a:"é€£çµ¡ã™ã‚‹",pg:"contact"},{t:"ç”°ä¸­ã‚†ã†ã¨ãã‚“ã®AIæ—¥èªŒãƒ‰ãƒ©ãƒ•ãƒˆãŒå®Œæˆã—ã¾ã—ãŸã€‚",tp:"i",a:"ç¢ºèªã™ã‚‹",pg:"journal"},{t:"æ¥é€±ã®ç¯€åˆ†ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ¡ˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚",tp:"s",a:"è¦‹ã‚‹",pg:"event"}].map((s,i)=>
          <div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 14px",borderRadius:10,marginBottom:8,background:s.tp==="w"?C.accentLight:s.tp==="i"?C.infoLight:C.primaryLight}}>
            <div style={{fontSize:13,color:C.g700,flex:1}}>{s.t}</div><Btn v="secondary" sz="sm" onClick={()=>setSubPage(s.pg)}>{s.a}</Btn></div>)}</Card>
      <Card><Sec icon="ğŸ•" title="ä»Šæ—¥ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«"/>
        <div style={{maxHeight:280,overflow:"auto"}}>
          {ACTIVITIES.map((a,i)=><div key={i} style={{display:"flex",alignItems:"center",gap:12,padding:"10px 0",borderBottom:i<ACTIVITIES.length-1?"1px solid "+C.g100:"none",opacity:i<4?.5:1}}>
            <div style={{fontSize:22}}>{a.icon}</div><div><div style={{fontSize:13,fontWeight:600,color:C.g900}}>{a.act}</div><div style={{fontSize:11,color:C.g500}}>{a.time}</div></div>
            {i<4&&<Badge color={C.g500}>å®Œäº†</Badge>}{i===4&&<Badge color={C.primary} bg={C.primaryLight}>é€²è¡Œä¸­</Badge>}</div>)}</div></Card>
    </div></div>;
};

// â”€â”€ Attendance â”€â”€
const AttPage=()=>{
  const[di,setDi]=useState(0);
  useEffect(()=>{const t=setInterval(()=>setDi(p=>(p+1)%CHILDREN.filter(c=>c.arrived).length),3000);return()=>clearInterval(t)},[]);
  const arr=CHILDREN.filter(c=>c.arrived);const d=arr[di];
  return <div><Sec icon="ğŸ“¸" title="AIç™»é™åœ’ç®¡ç†" sub="ç„é–¢ã‚«ãƒ¡ãƒ©ã«ã‚ˆã‚‹è‡ªå‹•é¡”èªè­˜"/>
    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20}}>
      <Card style={{background:"#000",padding:0,overflow:"hidden",position:"relative"}}>
        <div style={{padding:16,background:"rgba(0,0,0,.7)",position:"absolute",top:0,left:0,right:0,zIndex:1}}>
          <div style={{color:"#34D399",fontSize:12,fontWeight:700,display:"flex",alignItems:"center",gap:6}}>
            <div style={{width:8,height:8,borderRadius:"50%",background:"#EF4444"}}/>LIVE â€” ç„é–¢ã‚«ãƒ¡ãƒ©</div></div>
        <div style={{height:320,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg,#1a1a2e,#16213e)"}}>
          <div style={{textAlign:"center"}}><div style={{fontSize:80}}>{d?d.photo:"ğŸ§’"}</div>
            <div style={{marginTop:16,padding:"8px 20px",borderRadius:8,background:"rgba(16,185,129,.2)",border:"2px solid #34D399",color:"#34D399",fontWeight:700,fontSize:14}}>âœ… é¡”èªè­˜å®Œäº†: {d?d.name:"---"}</div>
            <div style={{color:"#9CA3AF",fontSize:12,marginTop:8}}>é€è¿è€…: {d?d.parent:"---"} ï½œ {d?d.time:"---"} ç™»åœ’</div></div></div></Card>
      <Card><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <div style={{fontSize:16,fontWeight:700,color:C.g900}}>ç™»é™åœ’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div><Badge color={C.primary}>{arr.length}/{CHILDREN.length}å ç™»åœ’æ¸ˆ</Badge></div>
        <div style={{maxHeight:260,overflow:"auto"}}>
          {CHILDREN.map(c=><div key={c.id} style={{display:"flex",alignItems:"center",gap:10,padding:"10px 0",borderBottom:"1px solid "+C.g100}}>
            <div style={{fontSize:24}}>{c.photo}</div>
            <div style={{flex:1}}><div style={{fontSize:13,fontWeight:600}}>{c.name}</div><div style={{fontSize:11,color:C.g500}}>{c.cls}</div></div>
            {c.arrived?<div style={{textAlign:"right"}}><Badge color={C.primary}>âœ“ {c.time}</Badge><div style={{fontSize:10,color:C.g500,marginTop:2}}>é€è¿: {c.parent}</div></div>:<Badge color={C.danger} bg={C.dangerLight}>æœªç™»åœ’</Badge>}
          </div>)}</div></Card></div>
    <Card style={{background:C.accentLight,border:"1px solid "+C.accent}}>
      <div style={{display:"flex",alignItems:"center",gap:12}}><AITag/><span style={{fontSize:13,color:C.g700}}>ä¼Šè—¤ãã†ãŸãã‚“ãŒ9:30æ™‚ç‚¹ã§æœªç™»åœ’ã§ã™ã€‚ä¿è­·è€…ï¼ˆæ¯ï¼‰ã¸ç¢ºèªé€£çµ¡ã‚’é€ä¿¡ã—ã¾ã™ã‹ï¼Ÿ</span>
        <Btn v="accent" sz="sm">é€£çµ¡ã™ã‚‹</Btn><Btn v="secondary" sz="sm">å¾Œã§</Btn></div></Card></div>;
};

// â”€â”€ Journal Page with per-child data â”€â”€
const JournalPage=()=>{
  const arrivedChildren=CHILDREN.filter(c=>c.arrived);
  const[selId,setSelId]=useState(arrivedChildren[0].id);
  const[approved,setApproved]=useState({});
  const[editMode,setEditMode]=useState({});
  const[editText,setEditText]=useState({});
  const[toast,setToast]=useState("");
  const showToast=(msg)=>{setToast(msg);setTimeout(()=>setToast(""),2500)};

  const j=JOURNALS[selId]||JOURNALS[1];
  const child=CHILDREN.find(c=>c.id===selId);
  const diaryText=editText[selId]||j.diary;

  return <div>
    <Toast msg={toast}/>
    <Sec icon="ğŸ“" title="AIæ—¥èªŒãƒ»é€£çµ¡å¸³" sub="AIãŒè‡ªå‹•ç”Ÿæˆ â†’ ä¿è‚²å£«ãŒç¢ºèªãƒ»æ‰¿èªã™ã‚‹ã ã‘"/>
    <div style={{display:"flex",gap:8,marginBottom:16,flexWrap:"wrap"}}>
      {arrivedChildren.map(c=><div key={c.id} onClick={()=>setSelId(c.id)} style={{
        padding:"8px 14px",borderRadius:10,cursor:"pointer",background:selId===c.id?C.primary:"#fff",
        color:selId===c.id?"#fff":C.g700,border:"1px solid "+(selId===c.id?C.primary:C.g200),
        fontSize:13,fontWeight:600,display:"flex",alignItems:"center",gap:6,transition:"all .15s"}}>
        {c.photo} {c.name}{approved[c.id]&&<span style={{color:selId===c.id?"#fff":C.primary}}>âœ“</span>}
      </div>)}</div>
    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16}}>
      <Card>
        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
          <div style={{fontWeight:700,fontSize:15}}>ğŸ“‹ {child.name}ã®ä¿è‚²æ—¥èªŒ</div><AITag/></div>
        <div style={{fontSize:12,color:C.g500,marginBottom:8}}>ç´ æ: ã‚«ãƒ¡ãƒ©è¡Œå‹•èªè­˜ + éŸ³å£°ãƒ¡ãƒ¢ + å†™çœŸã‹ã‚‰è‡ªå‹•ç”Ÿæˆ</div>
        {editMode[selId]?
          <textarea value={diaryText} onChange={e=>setEditText(p=>({...p,[selId]:e.target.value}))}
            style={{width:"100%",minHeight:200,padding:16,borderRadius:10,border:"1px solid "+C.primary,fontSize:13,lineHeight:1.8,fontFamily:"inherit",resize:"vertical"}}/>
          :<div style={{background:C.g50,borderRadius:10,padding:16,fontSize:13,lineHeight:1.8,color:C.g700,whiteSpace:"pre-wrap",border:"1px solid "+C.g200,maxHeight:300,overflow:"auto"}}>{diaryText}</div>}
        <div style={{display:"flex",gap:8,marginTop:12}}>
          {!approved[selId]&&<Btn v="primary" onClick={()=>{setApproved(p=>({...p,[selId]:true}));setEditMode(p=>({...p,[selId]:false}));showToast("âœ… "+child.name+"ã®æ—¥èªŒã‚’æ‰¿èªã—ã¾ã—ãŸ")}}>âœ… æ‰¿èªã™ã‚‹</Btn>}
          {!editMode[selId]?<Btn v="secondary" onClick={()=>{setEditMode(p=>({...p,[selId]:true}));if(!editText[selId])setEditText(p=>({...p,[selId]:j.diary}))}}>âœï¸ ä¿®æ­£ã™ã‚‹</Btn>
          :<Btn v="primary" onClick={()=>{setEditMode(p=>({...p,[selId]:false}));showToast("ğŸ’¾ ä¿®æ­£ã‚’ä¿å­˜ã—ã¾ã—ãŸ")}}>ğŸ’¾ ä¿å­˜</Btn>}
        </div>
        {approved[selId]&&<div style={{marginTop:8,padding:"8px 12px",borderRadius:8,background:C.primaryLight,fontSize:12,color:C.primaryDark,fontWeight:600}}>âœ… æ‰¿èªæ¸ˆã¿ â€” é€£çµ¡å¸³ãŒä¿è­·è€…ã«é€ä¿¡ã•ã‚Œã¾ã™</div>}
      </Card>
      <Card>
        <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
          <div style={{fontWeight:700,fontSize:15}}>ğŸ’Œ é€£çµ¡å¸³ï¼ˆä¿è­·è€…å‘ã‘ï¼‰</div><AITag/></div>
        <div style={{fontSize:12,color:C.g500,marginBottom:8}}>æ—¥èªŒãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ä¿è­·è€…å‘ã‘ã«æ¸©ã‹ã„ãƒˆãƒ¼ãƒ³ã§è‡ªå‹•å¤‰æ›</div>
        <div style={{background:"#FFF7ED",borderRadius:10,padding:16,fontSize:13,lineHeight:1.8,color:C.g700,whiteSpace:"pre-wrap",border:"1px solid #FED7AA",maxHeight:300,overflow:"auto"}}>{j.parent}</div>
        <div style={{marginTop:12}}><div style={{fontSize:12,fontWeight:600,color:C.g700,marginBottom:8}}>ğŸ“¸ è‡ªå‹•é¸å®šã•ã‚ŒãŸå†™çœŸï¼ˆ3æšï¼‰</div>
          <div style={{display:"flex",gap:8}}>
            {j.photos.map((p,i)=><div key={i} style={{width:100,height:100,borderRadius:10,background:"linear-gradient(135deg,"+j.photoBg[i]+",#fff)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:13,color:C.g700,textAlign:"center",border:"1px solid "+C.g200,flexDirection:"column",gap:4,boxShadow:"0 2px 8px rgba(0,0,0,.08)"}}>
              <span style={{fontSize:28}}>{p.split(" ")[0]}</span>
              <span style={{fontSize:10}}>{p.split(" ").slice(1).join(" ")}</span>
            </div>)}</div></div>
      </Card>
    </div></div>;
};

// â”€â”€ Plan Page with working buttons â”€â”€
const PlanPage=()=>{
  const[sm,setSm]=useState(null);
  const[approvedM,setApprovedM]=useState({});
  const[regen,setRegen]=useState({});
  const[toast,setToast]=useState("");
  const showToast=(msg)=>{setToast(msg);setTimeout(()=>setToast(""),2500)};

  return <div>
    <Toast msg={toast}/>
    <Sec icon="ğŸ“…" title="AIå¹´é–“è¨ˆç”»" sub="åœ’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¿è‚²æ‰€ä¿è‚²æŒ‡é‡ã«åŸºã¥ãAIãŒè‡ªå‹•ç«‹æ¡ˆ"/>
    <Card style={{marginBottom:16}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <div style={{fontSize:16,fontWeight:700}}>2026å¹´åº¦ å¹´é–“è¨ˆç”» â€” ã²ã¾ã‚ã‚Šçµ„ï¼ˆ3ã€œ4æ­³å…ï¼‰</div>
        <div style={{display:"flex",gap:8}}><AITag/><Btn v="secondary" sz="sm" onClick={()=>showToast("ğŸ“„ PDFå‡ºåŠ›å‡¦ç†ã‚’é–‹å§‹ã—ã¾ã—ãŸ")}>ğŸ“¥ PDFå‡ºåŠ›</Btn></div></div>
      <div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:10}}>
        {PLAN.map((m,i)=><div key={i} onClick={()=>setSm(sm===i?null:i)} style={{
          padding:14,borderRadius:12,cursor:"pointer",transition:"all .15s",
          background:approvedM[i]?C.primaryLight:sm===i?"#EDE9FE":C.g50,
          border:"1px solid "+(approvedM[i]?C.primary:sm===i?C.purple:C.g200)}}>
          <div style={{display:"flex",justifyContent:"space-between"}}>
            <div style={{fontWeight:700,fontSize:14,color:C.primary}}>{m.m}</div>
            {approvedM[i]&&<span style={{fontSize:10,color:C.primary}}>âœ“æ‰¿èªæ¸ˆ</span>}
          </div>
          <div style={{fontSize:11,color:C.g500,marginBottom:6,fontStyle:"italic"}}>"{m.th}"</div>
          {m.ev.map((e,j)=><div key={j} style={{fontSize:12,color:C.g700,padding:"2px 0"}}>â€¢ {e}</div>)}
        </div>)}</div></Card>
    {sm!==null&&<Card style={{animation:"fadeIn .3s ease"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
        <div style={{fontSize:16,fontWeight:700}}>{PLAN[sm].m}ã®æœˆé–“è¨ˆç”»è©³ç´°</div>
        {regen[sm]&&<Badge color={C.accent}>å†ç”Ÿæˆæ¸ˆ</Badge>}
        <AITag/></div>
      <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12}}>
        <div style={{padding:14,background:C.g50,borderRadius:10}}>
          <div style={{fontSize:13,fontWeight:700,marginBottom:8,color:C.primary}}>ğŸ¯ ã­ã‚‰ã„</div>
          <div style={{fontSize:12,color:C.g700,lineHeight:1.6}}>{PLAN[sm].th}ã“ã¨ã‚’ç›®æ¨™ã«ã€åœ’å…ä¸€äººã²ã¨ã‚Šã®ç™ºé”ã«åˆã‚ã›ãŸæ´»å‹•ã‚’å±•é–‹ã™ã‚‹ã€‚{regen[sm]?" ã€AIã«ã‚ˆã‚Šå†æ§‹æˆæ¸ˆã¿ã€‘":""}</div></div>
        <div style={{padding:14,background:C.g50,borderRadius:10}}>
          <div style={{fontSize:13,fontWeight:700,marginBottom:8,color:C.info}}>ğŸ“š æ´»å‹•å†…å®¹</div>
          {PLAN[sm].ev.map((e,i)=><div key={i} style={{fontSize:12,color:C.g700,padding:"3px 0"}}>â€¢ {e}</div>)}</div>
        <div style={{padding:14,background:C.g50,borderRadius:10}}>
          <div style={{fontSize:13,fontWeight:700,marginBottom:8,color:C.accent}}>ğŸ“ é…æ…®äº‹é …</div>
          <div style={{fontSize:12,color:C.g700,lineHeight:1.6}}>ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼å…ã¸ã®å¯¾å¿œç¢ºèªã€‚å®‰å…¨é¢ã®ç‚¹æ¤œã‚’å®Ÿæ–½ã€‚ä¿è­·è€…ã¨ã®é€£æºã‚’å¯†ã«ã€‚</div></div>
      </div>
      <div style={{display:"flex",gap:8,marginTop:12}}>
        <Btn v="primary" sz="sm" disabled={approvedM[sm]} onClick={()=>{setApprovedM(p=>({...p,[sm]:true}));showToast("âœ… "+PLAN[sm].m+"ã®è¨ˆç”»ã‚’æ‰¿èªã—ã¾ã—ãŸ")}}>
          {approvedM[sm]?"âœ… æ‰¿èªæ¸ˆã¿":"âœ… ã“ã®è¨ˆç”»ã‚’æ‰¿èª"}</Btn>
        <Btn v="secondary" sz="sm" onClick={()=>showToast("âœï¸ ä¿®æ­£ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸï¼ˆãƒ‡ãƒ¢ï¼‰")}>âœï¸ ä¿®æ­£</Btn>
        <Btn v="secondary" sz="sm" onClick={()=>{setRegen(p=>({...p,[sm]:true}));showToast("ğŸ”„ AIãŒ"+PLAN[sm].m+"ã®è¨ˆç”»ã‚’å†ç”Ÿæˆã—ã¾ã—ãŸ")}}>ğŸ”„ AIå†ç”Ÿæˆ</Btn>
        <Btn v="secondary" sz="sm" onClick={()=>showToast("ğŸ“„ "+PLAN[sm].m+"ã®PDFå‡ºåŠ›ã‚’é–‹å§‹ã—ã¾ã—ãŸ")}>ğŸ“¥ PDFå‡ºåŠ›</Btn>
      </div>
    </Card>}
  </div>;
};

// â”€â”€ Event Page â”€â”€
const EventPage=()=>{
  const[sp,setSp]=useState(false);const[toast,setToast]=useState("");
  const showToast=(msg)=>{setToast(msg);setTimeout(()=>setToast(""),2500)};
  return <div><Toast msg={toast}/>
    <Sec icon="ğŸª" title="AIã‚¤ãƒ™ãƒ³ãƒˆä¼ç”»" sub="åœ’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã«åŸºã¥ãã€ã‚ªãƒªã‚¸ãƒŠãƒªãƒ†ã‚£ã®ã‚ã‚‹ä¼ç”»ã‚’AIãŒè‡ªå‹•ç”Ÿæˆ"/>
    <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16}}>
      <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸƒ ç›´è¿‘ã®ã‚¤ãƒ™ãƒ³ãƒˆ</div>
        {[{n:"ç¯€åˆ†ãƒ»è±†ã¾ãä¼š",d:"2/3",s:"å®Œäº†",c:C.g500},{n:"ä½œå“å±•",d:"2/21",s:"æº–å‚™ä¸­",c:C.accent},{n:"ã²ãªç¥­ã‚Šä¼š",d:"3/3",s:"ä¼ç”»ä¸­",c:C.info},{n:"å’åœ’å¼",d:"3/20",s:"ä¼ç”»ä¸­",c:C.info}].map((e,i)=>
          <div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid "+C.g100}}>
            <div><div style={{fontSize:14,fontWeight:600}}>{e.n}</div><div style={{fontSize:12,color:C.g500}}>{e.d}</div></div><Badge color={e.c}>{e.s}</Badge></div>)}</Card>
      <Card style={{background:"linear-gradient(135deg,#EDE9FE,#DDD6FE)"}}>
        <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:12}}>
          <div style={{fontWeight:700,fontSize:15}}>ğŸ ã²ãªç¥­ã‚Šä¼š â€” AIä¼ç”»æ¡ˆ</div><AITag/></div>
        <div style={{fontSize:13,color:C.g700,lineHeight:1.8}}>åœ’ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®éå»å®Ÿç¸¾ã‚’åŸºã«ç”Ÿæˆã€‚</div>
        <div style={{background:"#fff",borderRadius:10,padding:14,marginTop:12}}>
          <div style={{fontSize:13,fontWeight:600,marginBottom:6}}>ğŸ“‹ ãƒ—ãƒ­ã‚°ãƒ©ãƒ æ¡ˆ</div>
          <div style={{fontSize:12,color:C.g700,lineHeight:1.8}}>1. é–‹ä¼šã®æŒ¨æ‹¶ï¼ˆ5åˆ†ï¼‰<br/>2. ã²ãªç¥­ã‚Šã‚¯ã‚¤ã‚ºï¼ˆ10åˆ†ï¼‰<br/>3. ã²ãªäººå½¢åˆ¶ä½œï¼ˆ25åˆ†ï¼‰<br/>4. åˆå”±ï¼ˆ5åˆ†ï¼‰<br/>5. è¨˜å¿µæ’®å½±ï¼ˆ10åˆ†ï¼‰<br/>6. ã²ãªã‚ã‚‰ã‚Œé…å¸ƒï¼ˆ5åˆ†ï¼‰</div></div>
        <div style={{display:"flex",gap:8,marginTop:12}}>
          <Btn v="primary" sz="sm" onClick={()=>setSp(true)}>ğŸ“„ ã‚¿ã‚¤ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«å‡ºåŠ›</Btn>
          <Btn v="secondary" sz="sm" onClick={()=>showToast("âœ… ä¼ç”»ã‚’æ‰¿èªã—ã¾ã—ãŸ")}>âœ… æ‰¿èª</Btn>
        </div></Card></div>
    {sp&&<Card style={{animation:"fadeIn .3s ease"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <div style={{fontWeight:700,fontSize:15}}>ğŸ–¨ï¸ å°åˆ·ç”¨ã‚¿ã‚¤ãƒ ãƒ†ãƒ¼ãƒ–ãƒ«</div>
        <div style={{display:"flex",gap:8}}><Btn v="secondary" sz="sm" onClick={()=>showToast("ğŸ“„ PDFå‡ºåŠ›ã‚’é–‹å§‹ã—ã¾ã—ãŸ")}>ğŸ“¥ PDFå‡ºåŠ›</Btn><Btn v="secondary" sz="sm" onClick={()=>setSp(false)}>âœ• é–‰ã˜ã‚‹</Btn></div></div>
      <div style={{border:"2px solid "+C.g200,borderRadius:10,padding:24}}>
        <div style={{textAlign:"center",marginBottom:20}}><div style={{fontSize:24,fontWeight:700}}>ğŸ ã²ãªç¥­ã‚Šä¼šãƒ—ãƒ­ã‚°ãƒ©ãƒ  ğŸ</div>
          <div style={{fontSize:14,color:C.g500,marginTop:4}}>2026å¹´3æœˆ3æ—¥ï¼ˆç«ï¼‰10:00ã€œ11:00 ï½œ ã²ã¾ã‚ã‚Šä¿è‚²åœ’ éŠæˆ¯å®¤</div></div>
        <table style={{width:"100%",borderCollapse:"collapse",fontSize:14}}>
          <thead><tr style={{background:"#FDF2F8"}}>{["æ™‚é–“","å†…å®¹","æ‹…å½“","å‚™å“"].map((h,i)=><th key={i} style={{padding:"10px 12px",textAlign:"left",borderBottom:"2px solid #F9A8D4"}}>{h}</th>)}</tr></thead>
          <tbody>{[["10:00","é–‹ä¼šã®æŒ¨æ‹¶","åœ’é•·","ãƒã‚¤ã‚¯"],["10:05","ã²ãªç¥­ã‚Šã‚¯ã‚¤ã‚º","å±±ç”°å…ˆç”Ÿ","ãƒ‘ãƒãƒ«"],["10:15","ã²ãªäººå½¢åˆ¶ä½œ","å„æ‹…ä»»","ç´™çš¿ã€åƒä»£ç´™"],["10:40","åˆå”±","éˆ´æœ¨å…ˆç”Ÿ","æ¥½è­œ"],["10:45","è¨˜å¿µæ’®å½±","äº‹å‹™å“¡","ã‚«ãƒ¡ãƒ©"],["10:55","é…å¸ƒãƒ»é–‰ä¼š","å„æ‹…ä»»","ã²ãªã‚ã‚‰ã‚Œ"]].map((r,i)=>
            <tr key={i} style={{borderBottom:"1px solid "+C.g200}}>{r.map((c,j)=><td key={j} style={{padding:"10px 12px"}}>{c}</td>)}</tr>)}</tbody></table></div></Card>}
  </div>;
};

// â”€â”€ Meal Page â”€â”€
const MealPage=()=><div>
  <Sec icon="ğŸ±" title="é£Ÿäº‹ãƒ»ç”Ÿæ´»è¨˜éŒ²" sub="AIã‚«ãƒ¡ãƒ©ï¼‹ã‚»ãƒ³ã‚µãƒ¼ã§è‡ªå‹•è¨˜éŒ²"/>
  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16,marginBottom:16}}>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸš ä»Šæ—¥ã®çµ¦é£Ÿ</div>
      <div style={{fontSize:13,color:C.g500,marginBottom:12}}>ã”ã¯ã‚“ã€é¶ã®å”æšã’ã€ã»ã†ã‚Œã‚“è‰ã®ãŠã²ãŸã—ã€å‘³å™Œæ±</div>
      {[{l:"ã”ã¯ã‚“",v:90,c:C.primary},{l:"ä¸»èœ",v:80,c:C.info},{l:"å‰¯èœ",v:70,c:C.accent},{l:"æ±ç‰©",v:100,c:C.purple}].map((i,k)=>
        <div key={k} style={{marginBottom:10}}><div style={{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4}}>
          <span style={{color:C.g700}}>{i.l}</span><span style={{fontWeight:600,color:i.c}}>{i.v}%</span></div><Prog value={i.v} color={i.c}/></div>)}
      <div style={{marginTop:8,fontSize:12,color:C.primary,fontWeight:600}}>ğŸ½ ãŠã‹ã‚ã‚Š: 1å›</div></Card>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ§¼ æ‰‹æ´—ã„è¨˜éŒ²</div>
      <div style={{textAlign:"center",padding:"20px 0"}}><div style={{fontSize:48,fontWeight:800,color:C.info}}>5</div><div style={{fontSize:14,color:C.g500}}>å› / æœ¬æ—¥</div></div>
      {["ç™»åœ’å¾Œ 8:12","å¤–éŠã³å¾Œ 11:05","çµ¦é£Ÿå‰ 11:45","ãŠã‚„ã¤å‰ 15:00","ãƒˆã‚¤ãƒ¬å¾Œ 14:30"].map((t,i)=>
        <div key={i} style={{padding:"6px 0",borderBottom:"1px solid "+C.g100,fontSize:12,display:"flex",alignItems:"center",gap:6}}><span style={{color:C.primary}}>âœ“</span>{t}</div>)}</Card>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸš» ãƒˆã‚¤ãƒ¬è¨˜éŒ²</div>
      <div style={{textAlign:"center",padding:"20px 0"}}><div style={{fontSize:48,fontWeight:800,color:C.purple}}>3</div><div style={{fontSize:14,color:C.g500}}>å› / æœ¬æ—¥</div></div>
      {["9:30 â€” ãŠã—ã£ã“ âœ“","12:30 â€” ãŠã—ã£ã“ âœ“","14:15 â€” ãŠã—ã£ã“ãƒ»ã†ã‚“ã¡ âœ“"].map((t,i)=>
        <div key={i} style={{padding:"6px 0",borderBottom:"1px solid "+C.g100,fontSize:12}}>{t}</div>)}
      <div style={{marginTop:12,padding:"8px 12px",borderRadius:8,background:C.primaryLight,fontSize:11,color:C.primaryDark}}>âœ“ æ’æ³„ãƒªã‚ºãƒ ã¯æ­£å¸¸ç¯„å›²ã§ã™</div></Card></div>
  <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ“Š ã‚¯ãƒ©ã‚¹å…¨ä½“ã®é£Ÿäº‹æ‘‚å–ç‡ï¼ˆä»Šé€±ï¼‰</div>
    <MultiBarChart data={[{d:"æœˆ",ã”:88,ä¸»:82,å‰¯:65,æ±:90},{d:"ç«",ã”:92,ä¸»:78,å‰¯:70,æ±:88},{d:"æ°´",ã”:85,ä¸»:85,å‰¯:60,æ±:92},{d:"æœ¨",ã”:90,ä¸»:80,å‰¯:72,æ±:95},{d:"é‡‘",ã”:87,ä¸»:83,å‰¯:68,æ±:91}]}
      bars={[{key:"ã”",color:C.primary,name:"ã”ã¯ã‚“"},{key:"ä¸»",color:C.info,name:"ä¸»èœ"},{key:"å‰¯",color:C.accent,name:"å‰¯èœ"},{key:"æ±",color:C.purple,name:"æ±ç‰©"}]} nameKey="d" height={200}/></Card></div>;

// â”€â”€ Vital Page with tabs â”€â”€
const VitalPage=()=>{
  const[selChild,setSelChild]=useState(CHILDREN[0].id);
  const[tab,setTab]=useState("today");
  const child=CHILDREN.find(c=>c.id===selChild);
  const tData=useMemo(()=>genVitalToday(selChild),[selChild]);
  const wData=useMemo(()=>genVitalWeek(selChild),[selChild]);
  const mData=useMemo(()=>genVitalMonth(selChild),[selChild]);
  const yData=useMemo(()=>genVitalYear(selChild),[selChild]);

  return <div>
    <Sec icon="ğŸ’“" title="ãƒã‚¤ã‚¿ãƒ«ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°" sub="ã‚¦ã‚§ã‚¢ãƒ©ãƒ–ãƒ«ãƒ‡ãƒã‚¤ã‚¹é€£æº â€” ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–"/>
    <div style={{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gap:12,marginBottom:16}}>
      {CHILDREN.filter(c=>c.arrived&&c.hr).map(c=>
        <Card key={c.id} onClick={()=>setSelChild(c.id)} style={{padding:14,border:selChild===c.id?"2px solid "+C.primary:"2px solid transparent"}}>
          <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:8}}>
            <span style={{fontSize:24}}>{c.photo}</span>
            <div><div style={{fontSize:13,fontWeight:600}}>{c.name}</div><div style={{fontSize:11,color:C.g500}}>{c.cls}</div></div></div>
          <div style={{display:"flex",gap:8}}>
            {[{l:"å¿ƒæ‹æ•°",v:c.hr,u:"bpm",bg:C.dangerLight,c:C.danger},{l:"SpO2",v:c.spo2,u:"%",bg:C.infoLight,c:C.info},{l:"ä½“æ¸©",v:c.temp,u:"Â°C",bg:C.accentLight,c:C.accent}].map((x,i)=>
              <div key={i} style={{flex:1,background:x.bg,borderRadius:8,padding:"6px 8px",textAlign:"center"}}>
                <div style={{fontSize:9,color:C.g500}}>{x.l}</div><div style={{fontSize:16,fontWeight:700,color:x.c}}>{x.v}</div><div style={{fontSize:9,color:C.g500}}>{x.u}</div></div>)}</div>
          <div style={{marginTop:6,fontSize:11,color:C.primary,fontWeight:600}}>âœ“ æ­£å¸¸</div>
        </Card>)}</div>

    <Card>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
        <div style={{fontWeight:700,fontSize:15}}>ğŸ“ˆ {child?child.name:""} â€” ãƒã‚¤ã‚¿ãƒ«æ¨ç§»</div>
        <TabBar tabs={[{id:"today",label:"ä»Šæ—¥"},{id:"week",label:"1é€±é–“"},{id:"month",label:"1ãƒ¶æœˆ"},{id:"year",label:"1å¹´é–“"}]} cur={tab} setCur={setTab}/></div>

      {tab==="today"&&<div>
        <LineChartSVG data={tData} nameKey="time" height={220} lines={[
          {key:"hr",color:C.danger,name:"å¿ƒæ‹æ•° (bpm)",fill:true,min:60,max:120}]}/>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12}}>
          <div style={{padding:12,background:C.g50,borderRadius:10}}>
            <div style={{fontSize:12,color:C.g500}}>å¿ƒæ‹æ•°ï¼ˆå¹³å‡ï¼‰</div>
            <div style={{fontSize:24,fontWeight:700,color:C.danger}}>{Math.floor(tData.reduce((a,d)=>a+d.hr,0)/tData.length)} <span style={{fontSize:12}}>bpm</span></div></div>
          <div style={{padding:12,background:C.g50,borderRadius:10}}>
            <div style={{fontSize:12,color:C.g500}}>SpO2ï¼ˆå¹³å‡ï¼‰</div>
            <div style={{fontSize:24,fontWeight:700,color:C.info}}>{Math.floor(tData.reduce((a,d)=>a+d.spo2,0)/tData.length)} <span style={{fontSize:12}}>%</span></div></div></div>
        <div style={{marginTop:12,padding:"8px 12px",borderRadius:8,background:C.primaryLight,fontSize:12,color:C.primaryDark}}>ğŸ˜´ 13:00ã€œ15:00 ãŠæ˜¼å¯ä¸­ â€” å‘¼å¸ãƒ»å¿ƒæ‹ã¨ã‚‚ã«å®‰å®šã€‚ç•°å¸¸æ¤œçŸ¥ãªã—ã€‚</div>
      </div>}

      {tab==="week"&&<div>
        <LineChartSVG data={wData} nameKey="date" height={220} lines={[
          {key:"hrAvg",color:C.danger,name:"å¿ƒæ‹æ•°",fill:true,min:60,max:110},
          {key:"sleepScore",color:C.purple,name:"ç¡çœ ã‚¹ã‚³ã‚¢",min:50,max:100}]}/>
        <div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:8,marginTop:12}}>
          {wData.map((d,i)=><div key={i} style={{padding:10,background:C.g50,borderRadius:8,textAlign:"center"}}>
            <div style={{fontSize:11,color:C.g500}}>{d.date}({d.day})</div>
            <div style={{fontSize:16,fontWeight:700,color:d.sleepScore>=80?C.primary:d.sleepScore>=65?C.accent:C.danger}}>{d.sleepScore}</div>
            <div style={{fontSize:10,color:C.g500}}>ç¡çœ ã‚¹ã‚³ã‚¢</div></div>)}
        </div></div>}

      {tab==="month"&&<div>
        <LineChartSVG data={mData} nameKey="date" height={240} showDots={false} lines={[
          {key:"hrAvg",color:C.danger,name:"å¿ƒæ‹æ•°",fill:true,min:60,max:110},
          {key:"sleepScore",color:C.purple,name:"ç¡çœ ã‚¹ã‚³ã‚¢",min:50,max:100}]}/>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginTop:12}}>
          <div style={{padding:12,background:C.g50,borderRadius:10,textAlign:"center"}}>
            <div style={{fontSize:12,color:C.g500}}>å¹³å‡å¿ƒæ‹æ•°</div>
            <div style={{fontSize:22,fontWeight:700,color:C.danger}}>{Math.floor(mData.reduce((a,d)=>a+d.hrAvg,0)/mData.length)} bpm</div></div>
          <div style={{padding:12,background:C.g50,borderRadius:10,textAlign:"center"}}>
            <div style={{fontSize:12,color:C.g500}}>å¹³å‡SpO2</div>
            <div style={{fontSize:22,fontWeight:700,color:C.info}}>{(mData.reduce((a,d)=>a+d.spo2Avg,0)/mData.length).toFixed(1)}%</div></div>
          <div style={{padding:12,background:C.g50,borderRadius:10,textAlign:"center"}}>
            <div style={{fontSize:12,color:C.g500}}>å¹³å‡ç¡çœ ã‚¹ã‚³ã‚¢</div>
            <div style={{fontSize:22,fontWeight:700,color:C.purple}}>{Math.floor(mData.reduce((a,d)=>a+d.sleepScore,0)/mData.length)}</div></div>
        </div></div>}

      {tab==="year"&&<div>
        <LineChartSVG data={yData} nameKey="month" height={240} lines={[
          {key:"hrAvg",color:C.danger,name:"å¿ƒæ‹æ•°",fill:true,min:60,max:110},
          {key:"sleepScore",color:C.purple,name:"ç¡çœ ã‚¹ã‚³ã‚¢",min:50,max:100}]}/>
        <div style={{marginTop:12,padding:"12px 16px",borderRadius:10,background:C.primaryLight}}>
          <AITag/> <span style={{fontSize:12,color:C.primaryDark,marginLeft:8}}>1å¹´é–“ã‚’é€šã˜ã¦ãƒã‚¤ã‚¿ãƒ«ãƒ‡ãƒ¼ã‚¿ã¯å®‰å®šã—ã¦ãŠã‚Šã€æˆé•·ã«ä¼´ã†å¿ƒæ‹æ•°ã®å®‰å®šåŒ–å‚¾å‘ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚ç¡çœ ã‚¹ã‚³ã‚¢ã¯å­£ç¯€å¤‰å‹•ãŒã‚ã‚Šã¾ã™ãŒæ¦‚ã­è‰¯å¥½ã§ã™ã€‚</span>
        </div></div>}
    </Card></div>;
};

// â”€â”€ Growth Page â”€â”€
const GrowthPage=()=><div>
  <Sec icon="ğŸ“ˆ" title="æˆé•·ç®¡ç†ãƒ»ã‚¢ãƒ«ãƒãƒ " sub="èº«ä½“æ¸¬å®š ï¼‹ å†™çœŸè‡ªå‹•ç´ä»˜ã‘ ï¼‹ æ€ã„å‡ºã‚¢ãƒ«ãƒãƒ "/>
  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16}}>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ“ ç”°ä¸­ã‚†ã†ã¨ãã‚“ â€” æˆé•·æ›²ç·š</div>
      <LineChartSVG data={GROWTH} nameKey="m" height={240} lines={[{key:"h",color:C.info,name:"èº«é•·(cm)",min:95,max:108},{key:"w",color:C.accent,name:"ä½“é‡(kg)",min:14,max:18}]}/>
      <div style={{marginTop:8,padding:"8px 12px",borderRadius:8,background:C.primaryLight,fontSize:12,color:C.primaryDark}}>
        <AITag/> æˆé•·æ›²ç·šã¯æ¨™æº–ç¯„å›²å†…ã§é †èª¿ã§ã™ã€‚èº«é•·+5.7cm / ä½“é‡+1.7kg</div></Card>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ¯ ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã“ã¨</div>
      <div style={{maxHeight:300,overflow:"auto"}}>
        {[{d:"2/14",t:"åˆã‚ã¦é‰„æ£’ã®å‰å›ã‚ŠãŒã§ããŸï¼",i:"ğŸ¤¸"},{d:"2/10",t:"è‡ªåˆ†ã®åå‰ã‚’ã²ã‚‰ãŒãªã§æ›¸ã‘ãŸ",i:"âœï¸"},{d:"1/28",t:"ãŠå‹é”ã«ãŠã‚‚ã¡ã‚ƒã‚’ã€Œã©ã†ãã€ã§ããŸ",i:"ğŸ¤"},{d:"1/15",t:"ãƒœã‚¿ãƒ³ã‚’ä¸€äººã§ç•™ã‚ã‚‰ã‚ŒãŸ",i:"ğŸ‘•"},{d:"12/20",t:"ç™ºè¡¨ä¼šã§å¤§ããªå£°ã§ã‚»ãƒªãƒ•ãŒè¨€ãˆãŸ",i:"ğŸ¤"},{d:"12/5",t:"ç®¸ã‚’ä½¿ã£ã¦é£Ÿã¹ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸ",i:"ğŸ¥¢"},{d:"11/18",t:"ãƒˆã‚¤ãƒ¬ã‚’ä¸€äººã§ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸ",i:"ğŸš»"}].map((m,i)=>
          <div key={i} style={{display:"flex",gap:10,padding:"10px 0",borderBottom:"1px solid "+C.g100}}>
            <div style={{fontSize:24}}>{m.i}</div><div><div style={{fontSize:13,fontWeight:600,color:C.g900}}>{m.t}</div><div style={{fontSize:11,color:C.g500}}>{m.d}</div></div></div>)}</div></Card></div>
  <Card><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16}}>
    <div><div style={{fontWeight:700,fontSize:15}}>ğŸ“¸ æ€ã„å‡ºã‚¢ãƒ«ãƒãƒ  â€” AIè‡ªå‹•é¸å®š</div>
      <div style={{fontSize:12,color:C.g500,marginTop:2}}>é¡”èªè­˜ã§è‡ªå‹•ç´ä»˜ã‘ â†’ ãƒ™ã‚¹ãƒˆã‚·ãƒ§ãƒƒãƒˆã‚’AIãŒé¸å®š</div></div>
    <div style={{display:"flex",gap:8}}><AITag/><Btn v="primary" sz="sm">ğŸ–¨ ã‚¢ãƒ«ãƒãƒ å‡ºåŠ›</Btn></div></div>
    <div style={{display:"grid",gridTemplateColumns:"repeat(6,1fr)",gap:10}}>
      {[{l:"å…¥åœ’å¼",i:"ğŸŒ¸",m:"4æœˆ",bg:"#FFE4E1"},{l:"é è¶³",i:"ğŸ’",m:"5æœˆ",bg:"#E0FFE0"},{l:"ãƒ—ãƒ¼ãƒ«",i:"ğŸŠ",m:"7æœˆ",bg:"#E0F0FF"},{l:"å¤ç¥­ã‚Š",i:"ğŸ†",m:"7æœˆ",bg:"#FFF0E0"},{l:"é‹å‹•ä¼š",i:"ğŸƒ",m:"10æœˆ",bg:"#FFE4C4"},{l:"èŠ‹æ˜ã‚Š",i:"ğŸ ",m:"10æœˆ",bg:"#F5E6D3"},{l:"ãƒãƒ­ã‚¦ã‚£ãƒ³",i:"ğŸƒ",m:"10æœˆ",bg:"#FFF3E0"},{l:"ç™ºè¡¨ä¼š",i:"ğŸ­",m:"12æœˆ",bg:"#EDE9FE"},{l:"ã‚¯ãƒªã‚¹ãƒã‚¹",i:"ğŸ„",m:"12æœˆ",bg:"#E8F5E9"},{l:"ãŠæ­£æœˆ",i:"ğŸ",m:"1æœˆ",bg:"#FFF8E1"},{l:"ç¯€åˆ†",i:"ğŸ‘¹",m:"2æœˆ",bg:"#FFEBEE"},{l:"ãŠçµµæã",i:"ğŸ¨",m:"æ—¥å¸¸",bg:"#F3E5F5"}].map((p,i)=>
        <div key={i} style={{background:"linear-gradient(135deg,"+p.bg+",#fff)",borderRadius:10,padding:12,textAlign:"center",border:"1px solid "+C.g200,boxShadow:"0 2px 6px rgba(0,0,0,.05)"}}>
          <div style={{fontSize:32}}>{p.i}</div><div style={{fontSize:11,fontWeight:600,marginTop:4}}>{p.l}</div><div style={{fontSize:10,color:C.g500}}>{p.m}</div></div>)}</div></Card></div>;

// â”€â”€ Parent Views â”€â”€
const ParentHome=({userName})=><div style={{maxWidth:420,margin:"0 auto"}}>
  <Card style={{background:"linear-gradient(135deg,#064E3B,#065F46)",color:"#fff",marginBottom:16}}>
    <div style={{display:"flex",alignItems:"center",gap:12}}>
      <div style={{fontSize:48}}>ğŸ§’</div>
      <div>{userName&&<div style={{fontSize:12,opacity:.7,marginBottom:2}}>{userName}ã•ã‚“</div>}<div style={{fontSize:20,fontWeight:700}}>ç”°ä¸­ ã‚†ã†ã¨ãã‚“</div><div style={{fontSize:13,opacity:.8}}>ã²ã¾ã‚ã‚Šçµ„ï¼ˆ4æ­³å…ï¼‰</div>
        <div style={{marginTop:4}}><span style={{padding:"3px 10px",borderRadius:20,background:"rgba(52,211,153,.3)",fontSize:12,fontWeight:600}}>âœ“ ç™»åœ’æ¸ˆ 8:12</span></div></div></div></Card>
  <Card style={{marginBottom:12}}><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ“¬ ä»Šæ—¥ã®é€£çµ¡å¸³</div>
    <div style={{fontSize:13,lineHeight:1.8,color:C.g700}}>ä»Šæ—¥ã®ã‚†ã†ã¨ãã‚“ã¯å…ƒæ°—ã„ã£ã±ã„ã«éã”ã—ã¾ã—ãŸğŸŒŸ<br/><br/>æœã¯ãƒ–ãƒ­ãƒƒã‚¯ã§å¤§ããªãŠåŸã‚’ä½œã‚Šã¾ã—ãŸã€‚ãŠçµµæãã§ã¯ã”å®¶æ—ã®çµµã‚’æã„ã¦ãã‚Œã¾ã—ãŸã‚ˆã€‚<br/><br/>ãŠå¤–ã§ã¯ä½è—¤ã‚ãŠã„ã¡ã‚ƒã‚“ã¨ç ‚å ´ã§éŠã‚“ã§ã„ã¾ã—ãŸğŸ˜Š</div>
    <div style={{display:"flex",gap:8,marginTop:12}}>
      {[{e:"ğŸ¨",bg:"#FFE4C4"},{e:"ğŸ—",bg:"#B0E0E6"},{e:"â›±",bg:"#F0E68C"}].map((x,i)=>
        <div key={i} style={{width:80,height:80,borderRadius:10,background:"linear-gradient(135deg,"+x.bg+",#fff)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:28,boxShadow:"0 2px 6px rgba(0,0,0,.08)"}}>{x.e}</div>)}</div></Card>
  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12}}>
    {[{l:"ğŸš çµ¦é£Ÿ",v:"ã»ã¼å®Œé£Ÿ",s:"ãŠã‹ã‚ã‚Š1å›",c:C.primary},{l:"ğŸ˜´ ãŠæ˜¼å¯",v:"13:05ã€œ14:50",s:"ãã£ã™ã‚Šçœ ã‚Œã¾ã—ãŸ",c:C.info},{l:"ğŸ’“ ãƒã‚¤ã‚¿ãƒ«",v:"å…¨ã¦æ­£å¸¸",s:"HR 92 / SpO2 98%",c:C.primary},{l:"ğŸ§¼ æ‰‹æ´—ã„",v:"5å›",s:"ã—ã£ã‹ã‚Šã§ãã¾ã—ãŸ",c:C.purple}].map((k,i)=>
      <Card key={i} style={{padding:14}}><div style={{fontSize:12,color:C.g500}}>{k.l}</div><div style={{fontSize:16,fontWeight:700,color:k.c,marginTop:4}}>{k.v}</div><div style={{fontSize:11,color:C.g500}}>{k.s}</div></Card>)}</div>
  <Card><div style={{fontWeight:700,fontSize:15,marginBottom:8}}>ğŸ“… ä»Šé€±ã®ãŠçŸ¥ã‚‰ã›</div>
    {[{t:"2/21(é‡‘) ä½œå“å±•",i:"ğŸ¨"},{t:"3/3(ç«) ã²ãªç¥­ã‚Šä¼š",i:"ğŸ"}].map((n,i)=>
      <div key={i} style={{padding:"8px 0",borderBottom:"1px solid "+C.g100,fontSize:13,display:"flex",gap:8,alignItems:"center"}}><span style={{fontSize:18}}>{n.i}</span>{n.t}</div>)}</Card></div>;

const ParentTimeline=()=><div style={{maxWidth:420,margin:"0 auto"}}>
  <Sec icon="ğŸ“·" title="ä»Šæ—¥ã®ã‚ˆã†ã™" sub="AIãŒè‡ªå‹•ã§è¨˜éŒ²ã—ãŸæ´»å‹•ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³"/>
  {ACTIVITIES.slice(0,7).map((a,i)=><Card key={i} style={{marginBottom:10}}>
    <div style={{display:"flex",alignItems:"center",gap:10}}><div style={{fontSize:28}}>{a.icon}</div>
      <div style={{flex:1}}><div style={{fontSize:14,fontWeight:600}}>{a.act}</div><div style={{fontSize:11,color:C.g500}}>{a.time}</div></div></div></Card>)}</div>;

const ParentGrowth=()=><div style={{maxWidth:420,margin:"0 auto"}}>
  <Sec icon="ğŸ“ˆ" title="æˆé•·è¨˜éŒ²" sub="ã‚†ã†ã¨ãã‚“ã®æˆé•·ã®è»Œè·¡"/>
  <Card style={{marginBottom:16}}><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ“ èº«é•·ãƒ»ä½“é‡ã®æ¨ç§»</div>
    <LineChartSVG data={GROWTH} nameKey="m" height={220} lines={[{key:"h",color:C.info,name:"èº«é•·(cm)",min:95,max:108},{key:"w",color:C.accent,name:"ä½“é‡(kg)",min:14,max:18}]}/></Card>
  <Card><div style={{fontWeight:700,fontSize:15,marginBottom:8}}>ğŸ¯ æœ€è¿‘ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã“ã¨</div>
    {[{d:"2/14",t:"åˆã‚ã¦é‰„æ£’ã®å‰å›ã‚ŠãŒã§ããŸï¼ğŸ¤¸"},{d:"2/10",t:"è‡ªåˆ†ã®åå‰ã‚’ã²ã‚‰ãŒãªã§æ›¸ã‘ãŸ âœï¸"},{d:"1/28",t:"ãŠå‹é”ã«ã€Œã©ã†ãã€ãŒã§ããŸ ğŸ¤"}].map((m,i)=>
      <div key={i} style={{padding:"10px 0",borderBottom:"1px solid "+C.g100,fontSize:13}}><div style={{fontWeight:600}}>{m.t}</div><div style={{fontSize:11,color:C.g500}}>{m.d}</div></div>)}</Card></div>;

// â”€â”€ Director Views â”€â”€
const DirDash=({userName})=><div>
  <div style={{marginBottom:24}}><h1 style={{fontSize:24,fontWeight:800,color:C.g900,margin:0}}>{userName?userName+"ã•ã‚“ã€":""}åœ’é•·ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
    <p style={{color:C.g500,margin:"4px 0 0",fontSize:14}}>2026å¹´2æœˆ17æ—¥ï¼ˆç«ï¼‰ï½œã²ã¾ã‚ã‚Šä¿è‚²åœ’</p></div>
  <div style={{display:"grid",gridTemplateColumns:"repeat(4,1fr)",gap:12,marginBottom:20}}>
    {[{l:"åœ¨ç±åœ’å…æ•°",v:"87å",s:"å®šå“¡90åï¼ˆ96.7%ï¼‰",c:C.primary},{l:"æœ¬æ—¥å‡ºå¸­",v:"82å",s:"å‡ºå¸­ç‡94.3%",c:C.info},{l:"è·å“¡å‡ºå‹¤",v:"14å",s:"é…ç½®å……è¶³ âœ“",c:C.purple},{l:"AIè¨˜éŒ²å®Œäº†",v:"96%",s:"æ®‹ã‚Š3å æ‰¿èªå¾…ã¡",c:C.accent}].map((k,i)=>
      <Card key={i}><div style={{fontSize:12,color:C.g500}}>{k.l}</div><div style={{fontSize:28,fontWeight:800,color:k.c,marginTop:4}}>{k.v}</div><div style={{fontSize:11,color:C.g500,marginTop:2}}>{k.s}</div></Card>)}</div>
  <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:16}}>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>ğŸ“Š ä»Šé€±ã®å‡ºå¸­æ¨ç§»</div>
      <SimpleBarChart data={[{d:"æœˆ",c:84},{d:"ç«",c:82},{d:"æ°´",c:80},{d:"æœ¨",c:85},{d:"é‡‘",c:78}]} dataKey="c" nameKey="d" color={C.primary} height={220} domain={[60,90]} unit="å"/></Card>
    <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>â± AIæ¥­å‹™åŠ¹ç‡åŒ–ã®åŠ¹æœ</div>
      {[{l:"æ—¥èªŒä½œæˆæ™‚é–“",b:"45åˆ†/æ—¥",a:"5åˆ†/æ—¥",s:"89%å‰Šæ¸›"},{l:"é€£çµ¡å¸³ä½œæˆ",b:"60åˆ†/æ—¥",a:"8åˆ†/æ—¥",s:"87%å‰Šæ¸›"},{l:"å¹´é–“è¨ˆç”»ç­–å®š",b:"2é€±é–“",a:"2æ™‚é–“",s:"98%å‰Šæ¸›"},{l:"åˆç¡ãƒã‚§ãƒƒã‚¯",b:"å¸¸æ™‚äººæ‰‹",a:"è‡ªå‹•ç›£è¦–",s:"äººæ‰‹ä¸è¦"}].map((e,i)=>
        <div key={i} style={{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderBottom:"1px solid "+C.g100}}>
          <div style={{fontSize:13,fontWeight:600,flex:1}}>{e.l}</div><div style={{fontSize:12,color:C.g500,flex:1,textAlign:"center"}}>{e.b} â†’ {e.a}</div><Badge color={C.primary}>{e.s}</Badge></div>)}</Card></div>
  <Card><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}}>
    <div style={{fontWeight:700,fontSize:15}}>ğŸ’¡ AIã‚¤ãƒ³ã‚µã‚¤ãƒˆ</div><AITag/></div>
    {[{i:"ğŸ“ˆ",t:"ä»Šæœˆã®å‡ºå¸­ç‡ã¯94.3%ã§æ˜¨å¹´åŒæœˆæ¯”+2.1%ã§ã™ã€‚"},{i:"ğŸ‘©â€ğŸ«",t:"3/20å’åœ’å¼ã®é€±ã¯è¿½åŠ äººå“¡ãŒå¿…è¦ã§ã™ã€‚"},{i:"ğŸ±",t:"å‰¯èœã®æ‘‚å–ç‡ãŒä½ä¸‹å‚¾å‘ã€‚çŒ®ç«‹ã®è¦‹ç›´ã—ã‚’æ¤œè¨ãã ã•ã„ã€‚"},{i:"ğŸ’°",t:"å»¶é•·ä¿è‚²æ–™ å‰æœˆæ¯”+8%ã€‚ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ¬ã‚¹åˆ©ç”¨ç‡72%ã«ä¸Šæ˜‡ã€‚"}].map((x,i)=>
      <div key={i} style={{padding:"10px 0",borderBottom:"1px solid "+C.g100,display:"flex",gap:10,fontSize:13}}><span style={{fontSize:20}}>{x.i}</span><span style={{color:C.g700}}>{x.t}</span></div>)}</Card></div>;

const DirStaff=()=><div>
  <Sec icon="ğŸ‘©â€ğŸ«" title="è·å“¡ç®¡ç†" sub="ã‚·ãƒ•ãƒˆç®¡ç†ãƒ»AIæœ€é©é…ç½®"/>
  <Card><div style={{fontWeight:700,fontSize:15,marginBottom:12}}>æœ¬æ—¥ã®è·å“¡é…ç½®</div>
    <table style={{width:"100%",borderCollapse:"collapse",fontSize:13}}>
      <thead><tr style={{background:C.g50}}>{["åå‰","æ‹…å½“","ã‚·ãƒ•ãƒˆ","çŠ¶æ…‹"].map((h,i)=><th key={i} style={{padding:"10px 12px",textAlign:"left",borderBottom:"2px solid "+C.g200}}>{h}</th>)}</tr></thead>
      <tbody>{[["å±±ç”° èŠ±å­","ã²ã¾ã‚ã‚Šçµ„","8:00ã€œ17:00","å‹¤å‹™ä¸­"],["éˆ´æœ¨ å¤ªéƒ","ã•ãã‚‰çµ„","8:00ã€œ17:00","å‹¤å‹™ä¸­"],["ä½è—¤ ç¾å’²","ãŸã‚“ã½ã½çµ„","8:30ã€œ17:30","å‹¤å‹™ä¸­"],["ç”°æ‘ ç›´ç¾","ãƒ•ãƒªãƒ¼","9:00ã€œ18:00","å‹¤å‹™ä¸­"],["é«˜æ©‹ æµ","çµ¦é£Ÿ","7:00ã€œ16:00","å‹¤å‹™ä¸­"]].map((r,i)=>
        <tr key={i} style={{borderBottom:"1px solid "+C.g100}}>{r.map((c,j)=><td key={j} style={{padding:"10px 12px"}}>{j===3?<Badge color={C.primary}>{c}</Badge>:c}</td>)}</tr>)}</tbody></table></Card></div>;

// â”€â”€ Main App â”€â”€
function App(){
  const[step,setStep]=useState("roleSelect"); // roleSelect -> login -> app
  const[role,setRole]=useState(null);
  const[user,setUser]=useState(null);
  const[page,setPage]=useState("dashboard");

  const handleRoleSelect=(r)=>{setRole(r);setStep("login")};
  const handleLogin=(u)=>{setUser(u);setStep("app");
    setPage(role==="teacher"?"dashboard":role==="parent"?"p_home":"d_dashboard")};
  const handleLogout=()=>{setStep("roleSelect");setRole(null);setUser(null);setPage("dashboard")};
  const switchRole=(r)=>{setRole(r);setPage(r==="teacher"?"dashboard":r==="parent"?"p_home":"d_dashboard")};

  if(step==="roleSelect")return <RoleSelectScreen onSelectRole={handleRoleSelect}/>;
  if(step==="login")return <LoginScreen role={role} onLogin={handleLogin} onBack={()=>setStep("roleSelect")}/>;

  const un=user?user.name:"";
  const renderPage=()=>{
    switch(page){
      case "dashboard":return <TeacherDash userName={un}/>;case "attendance":return <AttPage/>;
      case "journal":return <JournalPage/>;case "plan":return <PlanPage/>;
      case "event":return <EventPage/>;case "meal":return <MealPage/>;
      case "vital":return <VitalPage/>;case "growth":return <GrowthPage/>;
      case "p_home":return <ParentHome userName={un}/>;case "p_timeline":return <ParentTimeline/>;
      case "p_growth":return <ParentGrowth/>;case "d_dashboard":return <DirDash userName={un}/>;
      case "d_staff":return <DirStaff/>;case "d_plan":return <PlanPage/>;
      default:return <TeacherDash userName={un}/>;
    }
  };

  return <div style={{display:"flex",minHeight:"100vh",background:C.g50}}>
    <Sidebar role={role} cur={page} setPage={setPage} onLogout={handleLogout} userName={user?user.name:""}/>
    <div style={{flex:1,padding:28,overflowY:"auto",maxHeight:"100vh"}}>
      <div style={{maxWidth:1200,margin:"0 auto"}}>
        <div style={{display:"flex",justifyContent:"flex-end",marginBottom:16,gap:8}}>
          {role!=="teacher"&&<Btn v="secondary" sz="sm" onClick={()=>switchRole("teacher")}>ğŸ‘©â€ğŸ« ä¿è‚²å£«</Btn>}
          {role!=="director"&&<Btn v="secondary" sz="sm" onClick={()=>switchRole("director")}>ğŸ‘¨â€ğŸ’¼ åœ’é•·</Btn>}
          {role!=="parent"&&<Btn v="secondary" sz="sm" onClick={()=>switchRole("parent")}>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ä¿è­·è€…</Btn>}
        </div>
        {renderPage()}
      </div></div></div>;
}

const root=ReactDOM.createRoot(document.getElementById('root'));
root.render(<App/>);
</script>
<script>
window.onerror=function(msg){
  var el=document.getElementById('lf');
  if(el){el.style.display='flex';el.innerHTML='<div style="text-align:center;max-width:500px;padding:20px"><div style="font-size:48px;margin-bottom:16px">âš ï¸</div><h2>èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼</h2><p style="margin-top:8px;opacity:.8">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p><p style="font-size:11px;opacity:.4;margin-top:12px">'+msg+'</p></div>'}
  return true};
</script>
</body>
</html>
